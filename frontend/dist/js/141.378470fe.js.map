{"version":3,"file":"js/141.378470fe.js","mappings":"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","sources":["webpack://logtool-frontend/./src/views/Roles.vue","webpack://logtool-frontend/./src/views/Roles.vue?cb65"],"sourcesContent":["<template>\r\n  <div class=\"roles-container\">\r\n    <!-- 操作栏 -->\r\n    <div class=\"action-bar\">\r\n      <el-button type=\"primary\" @click=\"showAddDialog = true\">\r\n        <el-icon><Plus /></el-icon>\r\n        添加角色\r\n      </el-button>\r\n    </div>\r\n    \r\n    <!-- 角色列表 -->\r\n    <el-card class=\"list-card\">\r\n      <el-table\r\n        :data=\"roles\"\r\n        :loading=\"loading\"\r\n        style=\"width: 100%\"\r\n        v-loading=\"loading\"\r\n      >\r\n        <el-table-column prop=\"name\" label=\"角色名称\" width=\"150\" />\r\n        <el-table-column prop=\"description\" label=\"角色描述\" show-overflow-tooltip />\r\n        <el-table-column prop=\"permissions\" label=\"权限\" width=\"300\">\r\n          <template #default=\"{ row }\">\r\n            <el-tag \r\n              v-for=\"permission in row.permissions\" \r\n              :key=\"permission\"\r\n              size=\"small\"\r\n              style=\"margin-right: 5px; margin-bottom: 5px;\"\r\n            >\r\n              {{ permission }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"createdAt\" label=\"创建时间\" width=\"180\">\r\n          <template #default=\"{ row }\">\r\n            {{ formatDate(row.createdAt) }}\r\n          </template>\r\n        </el-table-column>\r\n        \r\n        <el-table-column label=\"操作\" width=\"150\" fixed=\"right\">\r\n          <template #default=\"{ row }\">\r\n            <el-button \r\n              size=\"small\" \r\n              @click=\"handleEdit(row)\"\r\n            >\r\n              编辑\r\n            </el-button>\r\n            <el-button \r\n              size=\"small\" \r\n              type=\"danger\" \r\n              @click=\"handleDelete(row)\"\r\n            >\r\n              删除\r\n            </el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </el-card>\r\n    \r\n    <!-- 添加/编辑角色对话框 -->\r\n    <el-dialog\r\n      v-model=\"showAddDialog\"\r\n      :title=\"editingRole ? '编辑角色' : '添加角色'\"\r\n      width=\"600px\"\r\n    >\r\n      <el-form\r\n        ref=\"roleForm\"\r\n        :model=\"roleForm\"\r\n        :rules=\"rules\"\r\n        label-width=\"100px\"\r\n      >\r\n        <el-form-item label=\"角色名称\" prop=\"name\">\r\n          <el-input v-model=\"roleForm.name\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"角色描述\" prop=\"description\">\r\n          <el-input\r\n            v-model=\"roleForm.description\"\r\n            type=\"textarea\"\r\n            :rows=\"3\"\r\n          />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"权限\" prop=\"permissions\">\r\n          <el-checkbox-group v-model=\"roleForm.permissions\">\r\n            <el-row :gutter=\"20\">\r\n              <el-col :span=\"12\">\r\n                <h4>用户管理</h4>\r\n                <el-checkbox value=\"user:read\">查看用户</el-checkbox>\r\n                <el-checkbox value=\"user:create\">创建用户</el-checkbox>\r\n                <el-checkbox value=\"user:update\">修改用户</el-checkbox>\r\n                <el-checkbox value=\"user:delete\">删除用户</el-checkbox>\r\n                <el-checkbox value=\"user:role:assign\">分配角色</el-checkbox>\r\n              </el-col>\r\n              <el-col :span=\"12\">\r\n                <h4>角色管理</h4>\r\n                <el-checkbox value=\"role:read\">查看角色</el-checkbox>\r\n                <el-checkbox value=\"role:create\">创建角色</el-checkbox>\r\n                <el-checkbox value=\"role:update\">修改角色</el-checkbox>\r\n                <el-checkbox value=\"role:delete\">删除角色</el-checkbox>\r\n              </el-col>\r\n            </el-row>\r\n            <el-row :gutter=\"20\" style=\"margin-top: 20px;\">\r\n              <el-col :span=\"12\">\r\n                <h4>故障码管理</h4>\r\n                <el-checkbox value=\"error_code:read\">查看故障码</el-checkbox>\r\n                <el-checkbox value=\"error_code:create\">创建故障码</el-checkbox>\r\n                <el-checkbox value=\"error_code:update\">修改故障码</el-checkbox>\r\n                <el-checkbox value=\"error_code:delete\">删除故障码</el-checkbox>\r\n                <el-checkbox value=\"error_code:export\">导出XML</el-checkbox>\r\n              </el-col>\r\n              <el-col :span=\"12\">\r\n                <h4>日志管理</h4>\r\n                <el-checkbox value=\"log:upload\">上传日志</el-checkbox>\r\n                <el-checkbox value=\"log:read_all\">查看所有日志</el-checkbox>\r\n                <el-checkbox value=\"log:read_own\">查看自己的日志</el-checkbox>\r\n                <el-checkbox value=\"log:parse\">解析日志</el-checkbox>\r\n                <el-checkbox value=\"log:download\">下载日志</el-checkbox>\r\n                <el-checkbox value=\"log:delete\">删除日志</el-checkbox>\r\n              </el-col>\r\n            </el-row>\r\n          </el-checkbox-group>\r\n        </el-form-item>\r\n      </el-form>\r\n      \r\n      <template #footer>\r\n        <el-button @click=\"showAddDialog = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"handleSave\" :loading=\"saving\">\r\n          保存\r\n        </el-button>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, reactive, computed, onMounted } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\n\r\nexport default {\r\n  name: 'Roles',\r\n  setup() {\r\n    const store = useStore()\r\n    \r\n    // 响应式数据\r\n    const loading = ref(false)\r\n    const saving = ref(false)\r\n    const showAddDialog = ref(false)\r\n    const editingRole = ref(null)\r\n    \r\n    const roleForm = reactive({\r\n      name: '',\r\n      description: '',\r\n      permissions: []\r\n    })\r\n    \r\n    const rules = {\r\n      name: [\r\n        { required: true, message: '请输入角色名称', trigger: 'blur' }\r\n      ],\r\n      description: [\r\n        { required: true, message: '请输入角色描述', trigger: 'blur' }\r\n      ]\r\n    }\r\n    \r\n    // 计算属性\r\n    const roles = computed(() => store.getters['users/rolesList'])\r\n    \r\n    // 方法\r\n    const loadRoles = async () => {\r\n      try {\r\n        loading.value = true\r\n        await store.dispatch('users/fetchRoles')\r\n      } catch (error) {\r\n        ElMessage.error('加载角色失败')\r\n      } finally {\r\n        loading.value = false\r\n      }\r\n    }\r\n    \r\n    const resetForm = () => {\r\n      Object.assign(roleForm, {\r\n        name: '',\r\n        description: '',\r\n        permissions: []\r\n      })\r\n      editingRole.value = null\r\n    }\r\n    \r\n    const handleEdit = (row) => {\r\n      editingRole.value = row\r\n      Object.assign(roleForm, {\r\n        name: row.name,\r\n        description: row.description,\r\n        permissions: row.permissions || []\r\n      })\r\n      showAddDialog.value = true\r\n    }\r\n    \r\n    const handleDelete = async (row) => {\r\n      try {\r\n        await ElMessageBox.confirm('确定要删除这个角色吗？', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        })\r\n        \r\n        await store.dispatch('users/deleteRole', row.id)\r\n        ElMessage.success('删除成功')\r\n        loadRoles()\r\n      } catch (error) {\r\n        if (error !== 'cancel') {\r\n          ElMessage.error('删除失败')\r\n        }\r\n      }\r\n    }\r\n    \r\n    const handleSave = async () => {\r\n      try {\r\n        saving.value = true\r\n        \r\n        if (editingRole.value) {\r\n          await store.dispatch('users/updateRole', {\r\n            id: editingRole.value.id,\r\n            data: roleForm\r\n          })\r\n          ElMessage.success('更新成功')\r\n        } else {\r\n          await store.dispatch('users/createRole', roleForm)\r\n          ElMessage.success('添加成功')\r\n        }\r\n        \r\n        showAddDialog.value = false\r\n        resetForm()\r\n        loadRoles()\r\n      } catch (error) {\r\n        ElMessage.error('保存失败')\r\n      } finally {\r\n        saving.value = false\r\n      }\r\n    }\r\n    \r\n    const formatDate = (dateString) => {\r\n      if (!dateString) return '-'\r\n      return new Date(dateString).toLocaleString('zh-CN')\r\n    }\r\n    \r\n    // 生命周期\r\n    onMounted(() => {\r\n      loadRoles()\r\n    })\r\n    \r\n    return {\r\n      loading,\r\n      saving,\r\n      showAddDialog,\r\n      editingRole,\r\n      roleForm,\r\n      rules,\r\n      roles,\r\n      handleEdit,\r\n      handleDelete,\r\n      handleSave,\r\n      formatDate\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.roles-container {\r\n  height: 100%;\r\n}\r\n\r\n.action-bar {\r\n  margin-bottom: 20px;\r\n  padding: 20px;\r\n  background: white;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.list-card {\r\n  margin-bottom: 20px;\r\n}\r\n\r\nh4 {\r\n  margin: 10px 0;\r\n  color: #333;\r\n  font-size: 14px;\r\n}\r\n\r\n.el-checkbox {\r\n  display: block;\r\n  margin-bottom: 8px;\r\n}\r\n</style> ","import { render } from \"./Roles.vue?vue&type=template&id=35ba23da&scoped=true\"\nimport script from \"./Roles.vue?vue&type=script&lang=js\"\nexport * from \"./Roles.vue?vue&type=script&lang=js\"\n\nimport \"./Roles.vue?vue&type=style&index=0&id=35ba23da&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-35ba23da\"]])\n\nexport default __exports__"],"names":["class","type","showAddDialog","data","roles","loading","style","prop","label","width","default","row","permissions","permission","key","size","formatDate","createdAt","fixed","handleEdit","handleDelete","title","editingRole","footer","handleSave","saving","ref","model","roleForm","rules","name","description","rows","gutter","span","value","setup","store","required","message","trigger","getters","loadRoles","async","dispatch","error","resetForm","Object","assign","confirm","confirmButtonText","cancelButtonText","id","success","dateString","Date","toLocaleString","__exports__","render"],"sourceRoot":""}