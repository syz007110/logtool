{"version":3,"file":"js/234.59299f8a.js","mappings":"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","sources":["webpack://logtool-frontend/./src/views/Users.vue","webpack://logtool-frontend/./src/views/Users.vue?d380"],"sourcesContent":["<template>\r\n  <div class=\"users-container\">\r\n    <!-- 操作栏 -->\r\n    <div class=\"action-bar\">\r\n      <div class=\"search-section\">\r\n        <el-input\r\n          v-model=\"searchQuery\"\r\n          placeholder=\"搜索用户...\"\r\n          style=\"width: 300px\"\r\n          clearable\r\n          @input=\"handleSearch\"\r\n        >\r\n          <template #prefix>\r\n            <el-icon><Search /></el-icon>\r\n          </template>\r\n        </el-input>\r\n      </div>\r\n      \r\n      <div class=\"action-section\">\r\n        <el-button type=\"primary\" @click=\"showAddDialog = true\">\r\n          <el-icon><Plus /></el-icon>\r\n          添加用户\r\n        </el-button>\r\n      </div>\r\n    </div>\r\n    \r\n    <!-- 用户列表 -->\r\n    <el-card class=\"list-card\">\r\n      <el-table\r\n        :data=\"users\"\r\n        :loading=\"loading\"\r\n        style=\"width: 100%\"\r\n        v-loading=\"loading\"\r\n      >\r\n        <el-table-column prop=\"username\" label=\"用户名\" width=\"150\" />\r\n        <el-table-column prop=\"email\" label=\"邮箱\" width=\"200\" />\r\n        <el-table-column prop=\"role\" label=\"角色\" width=\"120\">\r\n          <template #default=\"{ row }\">\r\n            <el-tag :type=\"getRoleType(row.role)\">\r\n              {{ getRoleText(row.role) }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"status\" label=\"状态\" width=\"100\">\r\n          <template #default=\"{ row }\">\r\n            <el-tag :type=\"row.status === 'active' ? 'success' : 'danger'\">\r\n              {{ row.status === 'active' ? '激活' : '禁用' }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"createdAt\" label=\"创建时间\" width=\"180\">\r\n          <template #default=\"{ row }\">\r\n            {{ formatDate(row.createdAt) }}\r\n          </template>\r\n        </el-table-column>\r\n        \r\n        <el-table-column label=\"操作\" width=\"250\" fixed=\"right\">\r\n          <template #default=\"{ row }\">\r\n            <el-button \r\n              size=\"small\" \r\n              @click=\"handleEdit(row)\"\r\n            >\r\n              编辑\r\n            </el-button>\r\n            <el-button \r\n              size=\"small\" \r\n              type=\"warning\"\r\n              @click=\"handleAssignRole(row)\"\r\n            >\r\n              分配角色\r\n            </el-button>\r\n            <el-button \r\n              size=\"small\" \r\n              type=\"danger\" \r\n              @click=\"handleDelete(row)\"\r\n            >\r\n              删除\r\n            </el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      \r\n      <!-- 分页 -->\r\n      <div class=\"pagination-wrapper\">\r\n        <el-pagination\r\n          :current-page=\"currentPage\"\r\n          :page-size=\"pageSize\"\r\n          :page-sizes=\"[10, 20, 50, 100]\"\r\n          :total=\"total\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n        />\r\n      </div>\r\n    </el-card>\r\n    \r\n    <!-- 添加/编辑用户对话框 -->\r\n    <el-dialog\r\n      v-model=\"showAddDialog\"\r\n      :title=\"editingUser ? '编辑用户' : '添加用户'\"\r\n      width=\"500px\"\r\n    >\r\n      <el-form\r\n        ref=\"userForm\"\r\n        :model=\"userForm\"\r\n        :rules=\"rules\"\r\n        label-width=\"100px\"\r\n      >\r\n        <el-form-item label=\"用户名\" prop=\"username\">\r\n          <el-input v-model=\"userForm.username\" :disabled=\"!!editingUser\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"邮箱\" prop=\"email\">\r\n          <el-input v-model=\"userForm.email\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item v-if=\"!editingUser\" label=\"密码\" prop=\"password\">\r\n          <el-input v-model=\"userForm.password\" type=\"password\" show-password />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"状态\" prop=\"status\">\r\n          <el-select v-model=\"userForm.status\" placeholder=\"选择状态\">\r\n            <el-option label=\"激活\" value=\"active\" />\r\n            <el-option label=\"禁用\" value=\"inactive\" />\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-form>\r\n      \r\n      <template #footer>\r\n        <el-button @click=\"showAddDialog = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"handleSave\" :loading=\"saving\">\r\n          保存\r\n        </el-button>\r\n      </template>\r\n    </el-dialog>\r\n    \r\n    <!-- 分配角色对话框 -->\r\n    <el-dialog\r\n      v-model=\"showRoleDialog\"\r\n      title=\"分配角色\"\r\n      width=\"400px\"\r\n    >\r\n      <el-form label-width=\"100px\">\r\n        <el-form-item label=\"用户\">\r\n          <span>{{ selectedUser?.username }}</span>\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"角色\">\r\n          <el-select v-model=\"selectedRole\" placeholder=\"选择角色\">\r\n            <el-option\r\n              v-for=\"role in roles\"\r\n              :key=\"role.id\"\r\n              :label=\"getRoleText(role.name)\"\r\n              :value=\"role.id\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-form>\r\n      \r\n      <template #footer>\r\n        <el-button @click=\"showRoleDialog = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"handleSaveRole\" :loading=\"savingRole\">\r\n          保存\r\n        </el-button>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, reactive, computed, onMounted } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\n\r\nexport default {\r\n  name: 'Users',\r\n  setup() {\r\n    const store = useStore()\r\n    \r\n    // 响应式数据\r\n    const loading = ref(false)\r\n    const saving = ref(false)\r\n    const savingRole = ref(false)\r\n    const showAddDialog = ref(false)\r\n    const showRoleDialog = ref(false)\r\n    const editingUser = ref(null)\r\n    const selectedUser = ref(null)\r\n    const searchQuery = ref('')\r\n    const currentPage = ref(1)\r\n    const pageSize = ref(20)\r\n    const selectedRole = ref('')\r\n    \r\n    const userForm = reactive({\r\n      username: '',\r\n      email: '',\r\n      password: '',\r\n      status: 'active'\r\n    })\r\n    \r\n    const rules = {\r\n      username: [\r\n        { required: true, message: '请输入用户名', trigger: 'blur' },\r\n        { min: 3, max: 20, message: '用户名长度在 3 到 20 个字符', trigger: 'blur' }\r\n      ],\r\n      email: [\r\n        { required: true, message: '请输入邮箱', trigger: 'blur' },\r\n        { type: 'email', message: '请输入正确的邮箱格式', trigger: 'blur' }\r\n      ],\r\n      password: [\r\n        { required: true, message: '请输入密码', trigger: 'blur' },\r\n        { min: 6, message: '密码长度不能少于 6 个字符', trigger: 'blur' }\r\n      ],\r\n      status: [\r\n        { required: true, message: '请选择状态', trigger: 'change' }\r\n      ]\r\n    }\r\n    \r\n    // 计算属性\r\n    const users = computed(() => store.getters['users/usersList'])\r\n    const roles = computed(() => store.getters['users/rolesList'])\r\n    const total = computed(() => store.getters['users/totalCount'])\r\n    \r\n    // 方法\r\n    const loadUsers = async () => {\r\n      try {\r\n        loading.value = true\r\n        await store.dispatch('users/fetchUsers', {\r\n          page: currentPage.value,\r\n          limit: pageSize.value,\r\n          search: searchQuery.value\r\n        })\r\n      } catch (error) {\r\n        ElMessage.error('加载用户失败')\r\n      } finally {\r\n        loading.value = false\r\n      }\r\n    }\r\n    \r\n    const loadRoles = async () => {\r\n      try {\r\n        await store.dispatch('users/fetchRoles')\r\n      } catch (error) {\r\n        ElMessage.error('加载角色失败')\r\n      }\r\n    }\r\n    \r\n    const handleSearch = () => {\r\n      currentPage.value = 1\r\n      loadUsers()\r\n    }\r\n    \r\n    const handleSizeChange = (size) => {\r\n      pageSize.value = size\r\n      currentPage.value = 1\r\n      loadUsers()\r\n    }\r\n    \r\n    const handleCurrentChange = (page) => {\r\n      currentPage.value = page\r\n      loadUsers()\r\n    }\r\n    \r\n    const resetForm = () => {\r\n      Object.assign(userForm, {\r\n        username: '',\r\n        email: '',\r\n        password: '',\r\n        status: 'active'\r\n      })\r\n      editingUser.value = null\r\n    }\r\n    \r\n    const handleEdit = (row) => {\r\n      editingUser.value = row\r\n      Object.assign(userForm, {\r\n        username: row.username,\r\n        email: row.email,\r\n        status: row.status\r\n      })\r\n      showAddDialog.value = true\r\n    }\r\n    \r\n    const handleDelete = async (row) => {\r\n      try {\r\n        await ElMessageBox.confirm('确定要删除这个用户吗？', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        })\r\n        \r\n        await store.dispatch('users/deleteUser', row.id)\r\n        ElMessage.success('删除成功')\r\n        loadUsers()\r\n      } catch (error) {\r\n        if (error !== 'cancel') {\r\n          ElMessage.error('删除失败')\r\n        }\r\n      }\r\n    }\r\n    \r\n    const handleSave = async () => {\r\n      try {\r\n        saving.value = true\r\n        \r\n        if (editingUser.value) {\r\n          await store.dispatch('users/updateUser', {\r\n            id: editingUser.value.id,\r\n            data: userForm\r\n          })\r\n          ElMessage.success('更新成功')\r\n        } else {\r\n          await store.dispatch('users/createUser', userForm)\r\n          ElMessage.success('添加成功')\r\n        }\r\n        \r\n        showAddDialog.value = false\r\n        resetForm()\r\n        loadUsers()\r\n      } catch (error) {\r\n        ElMessage.error('保存失败')\r\n      } finally {\r\n        saving.value = false\r\n      }\r\n    }\r\n    \r\n    const handleAssignRole = (row) => {\r\n      selectedUser.value = row\r\n      selectedRole.value = row.roleId || ''\r\n      showRoleDialog.value = true\r\n    }\r\n    \r\n    const handleSaveRole = async () => {\r\n      try {\r\n        savingRole.value = true\r\n        await store.dispatch('users/assignUserRole', selectedUser.value.id, selectedRole.value)\r\n        ElMessage.success('角色分配成功')\r\n        showRoleDialog.value = false\r\n        loadUsers()\r\n      } catch (error) {\r\n        ElMessage.error('角色分配失败')\r\n      } finally {\r\n        savingRole.value = false\r\n      }\r\n    }\r\n    \r\n    const getRoleType = (role) => {\r\n      const typeMap = {\r\n        admin: 'danger',\r\n        expert: 'warning',\r\n        user: 'info'\r\n      }\r\n      return typeMap[role] || 'info'\r\n    }\r\n    \r\n    const getRoleText = (role) => {\r\n      const textMap = {\r\n        admin: '管理员',\r\n        expert: '专家用户',\r\n        user: '普通用户'\r\n      }\r\n      return textMap[role] || role\r\n    }\r\n    \r\n    const formatDate = (dateString) => {\r\n      if (!dateString) return '-'\r\n      return new Date(dateString).toLocaleString('zh-CN')\r\n    }\r\n    \r\n    // 生命周期\r\n    onMounted(() => {\r\n      loadUsers()\r\n      loadRoles()\r\n    })\r\n    \r\n    return {\r\n      loading,\r\n      saving,\r\n      savingRole,\r\n      showAddDialog,\r\n      showRoleDialog,\r\n      editingUser,\r\n      selectedUser,\r\n      searchQuery,\r\n      currentPage,\r\n      pageSize,\r\n      selectedRole,\r\n      userForm,\r\n      rules,\r\n      users,\r\n      roles,\r\n      total,\r\n      handleSearch,\r\n      handleSizeChange,\r\n      handleCurrentChange,\r\n      handleEdit,\r\n      handleDelete,\r\n      handleSave,\r\n      handleAssignRole,\r\n      handleSaveRole,\r\n      getRoleType,\r\n      getRoleText,\r\n      formatDate\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.users-container {\r\n  height: 100%;\r\n}\r\n\r\n.action-bar {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n  padding: 20px;\r\n  background: white;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.action-section {\r\n  display: flex;\r\n  gap: 10px;\r\n}\r\n\r\n.list-card {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.pagination-wrapper {\r\n  display: flex;\r\n  justify-content: center;\r\n  margin-top: 20px;\r\n}\r\n</style> ","import { render } from \"./Users.vue?vue&type=template&id=886e1274&scoped=true\"\nimport script from \"./Users.vue?vue&type=script&lang=js\"\nexport * from \"./Users.vue?vue&type=script&lang=js\"\n\nimport \"./Users.vue?vue&type=style&index=0&id=886e1274&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-886e1274\"]])\n\nexport default __exports__"],"names":["class","searchQuery","placeholder","style","clearable","handleSearch","prefix","type","showAddDialog","data","users","loading","prop","label","width","default","row","getRoleType","role","getRoleText","status","formatDate","createdAt","fixed","size","handleEdit","handleAssignRole","handleDelete","currentPage","pageSize","total","layout","handleSizeChange","handleCurrentChange","title","editingUser","footer","handleSave","saving","ref","model","userForm","rules","username","disabled","email","password","value","showRoleDialog","handleSaveRole","savingRole","selectedUser","selectedRole","roles","key","id","name","setup","store","required","message","trigger","min","max","getters","loadUsers","async","dispatch","page","limit","search","error","loadRoles","resetForm","Object","assign","confirm","confirmButtonText","cancelButtonText","success","roleId","typeMap","admin","expert","user","textMap","dateString","Date","toLocaleString","__exports__","render"],"sourceRoot":""}