{"version":3,"file":"js/157.7b0f9e4f.js","mappings":"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","sources":["webpack://logtool-frontend/./src/views/History.vue","webpack://logtool-frontend/./src/views/History.vue?2c0e"],"sourcesContent":["<template>\r\n  <div class=\"history-container\">\r\n    <el-card>\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <span>{{ $t('history.title') }}</span>\r\n          <el-button type=\"primary\" size=\"small\" @click=\"loadHistory\">\r\n            <el-icon><Refresh /></el-icon>\r\n            {{ $t('common.refresh') }}\r\n          </el-button>\r\n        </div>\r\n      </template>\r\n      \r\n      <el-table\r\n        :data=\"historyList\"\r\n        :loading=\"loading\"\r\n        style=\"width: 100%\"\r\n        v-loading=\"loading\"\r\n      >\r\n        <el-table-column prop=\"operation\" :label=\"$t('history.operation')\" width=\"150\" />\r\n        <el-table-column prop=\"description\" :label=\"$t('history.description')\" show-overflow-tooltip />\r\n        <el-table-column prop=\"user\" :label=\"$t('history.user')\" width=\"120\" />\r\n        <el-table-column prop=\"time\" :label=\"$t('history.time')\" width=\"180\">\r\n          <template #default=\"{ row }\">\r\n            {{ formatDate(row.time) }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"status\" :label=\"$t('history.status')\" width=\"100\">\r\n          <template #default=\"{ row }\">\r\n            <el-tag :type=\"getStatusType(row.status)\">\r\n              {{ $t(getStatusText(row.status)) }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        \r\n        <el-table-column :label=\"$t('history.details')\" width=\"100\" fixed=\"right\">\r\n          <template #default=\"{ row }\">\r\n            <el-button \r\n              size=\"small\" \r\n              type=\"primary\"\r\n              @click=\"showDetails(row)\"\r\n            >\r\n              {{ $t('history.view') }}\r\n            </el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      \r\n      <!-- 分页 -->\r\n      <div class=\"pagination-wrapper\">\r\n        <el-pagination\r\n          :current-page=\"currentPage\"\r\n          :page-size=\"pageSize\"\r\n          :page-sizes=\"[10, 20, 50, 100]\"\r\n          :total=\"total\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n        />\r\n      </div>\r\n    </el-card>\r\n    \r\n    <!-- 详情对话框 -->\r\n    <el-dialog\r\n      v-model=\"showDetailsDialog\"\r\n      :title=\"$t('history.details')\"\r\n      width=\"600px\"\r\n    >\r\n      <div v-if=\"selectedRecord\">\r\n        <el-descriptions :column=\"1\" border>\r\n          <el-descriptions-item :label=\"$t('history.operation')\">{{ selectedRecord.operation }}</el-descriptions-item>\r\n          <el-descriptions-item :label=\"$t('history.description')\">{{ selectedRecord.description }}</el-descriptions-item>\r\n          <el-descriptions-item :label=\"$t('history.user')\">{{ selectedRecord.user }}</el-descriptions-item>\r\n          <el-descriptions-item :label=\"$t('history.time')\">{{ formatDate(selectedRecord.time) }}</el-descriptions-item>\r\n          <el-descriptions-item :label=\"$t('history.status')\">\r\n            <el-tag :type=\"getStatusType(selectedRecord.status)\">\r\n              {{ $t(getStatusText(selectedRecord.status)) }}\r\n            </el-tag>\r\n          </el-descriptions-item>\r\n          <el-descriptions-item :label=\"$t('history.ip')\">{{ selectedRecord.ip || '-' }}</el-descriptions-item>\r\n          <el-descriptions-item :label=\"$t('history.userAgent')\">{{ selectedRecord.userAgent || '-' }}</el-descriptions-item>\r\n        </el-descriptions>\r\n        \r\n        <div v-if=\"selectedRecord.details\" class=\"details-section\">\r\n          <h4>{{ $t('history.moreDetails') }}</h4>\r\n          <pre>{{ JSON.stringify(selectedRecord.details, null, 2) }}</pre>\r\n        </div>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted } from 'vue'\r\nimport { ElMessage } from 'element-plus'\r\nimport api from '../api'\r\n\r\nexport default {\r\n  name: 'History',\r\n  setup() {\r\n    // 响应式数据\r\n    const loading = ref(false)\r\n    const currentPage = ref(1)\r\n    const pageSize = ref(20)\r\n    const total = ref(0)\r\n    const historyList = ref([])\r\n    const showDetailsDialog = ref(false)\r\n    const selectedRecord = ref(null)\r\n    \r\n    // 方法\r\n    const loadHistory = async () => {\r\n      try {\r\n        loading.value = true\r\n        \r\n        const response = await api.operationLogs.getList({\r\n          page: currentPage.value,\r\n          limit: pageSize.value\r\n        })\r\n        \r\n        historyList.value = response.data.logs || []\r\n        total.value = response.data.total || 0\r\n      } catch (error) {\r\n        console.error('加载历史记录失败:', error)\r\n        ElMessage.error('加载历史记录失败')\r\n      } finally {\r\n        loading.value = false\r\n      }\r\n    }\r\n    \r\n    const handleSizeChange = (size) => {\r\n      pageSize.value = size\r\n      currentPage.value = 1\r\n      loadHistory()\r\n    }\r\n    \r\n    const handleCurrentChange = (page) => {\r\n      currentPage.value = page\r\n      loadHistory()\r\n    }\r\n    \r\n    const showDetails = (row) => {\r\n      selectedRecord.value = row\r\n      showDetailsDialog.value = true\r\n    }\r\n    \r\n    const formatDate = (dateString) => {\r\n      if (!dateString) return '-'\r\n      return new Date(dateString).toLocaleString('zh-CN')\r\n    }\r\n    \r\n    const getStatusType = (status) => {\r\n      const typeMap = {\r\n        success: 'success',\r\n        failed: 'danger',\r\n        pending: 'warning'\r\n      }\r\n      return typeMap[status] || 'info'\r\n    }\r\n    \r\n    const getStatusText = (status) => {\r\n      const textMap = {\r\n        success: 'history.statusSuccess',\r\n        failed: 'history.statusFailed',\r\n        pending: 'history.statusPending'\r\n      }\r\n      return textMap[status] || status\r\n    }\r\n    \r\n    // 生命周期\r\n    onMounted(() => {\r\n      loadHistory()\r\n    })\r\n    \r\n    return {\r\n      loading,\r\n      currentPage,\r\n      pageSize,\r\n      total,\r\n      historyList,\r\n      showDetailsDialog,\r\n      selectedRecord,\r\n      loadHistory,\r\n      handleSizeChange,\r\n      handleCurrentChange,\r\n      showDetails,\r\n      formatDate,\r\n      getStatusType,\r\n      getStatusText\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.history-container {\r\n  height: 100%;\r\n}\r\n\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.pagination-wrapper {\r\n  display: flex;\r\n  justify-content: center;\r\n  margin-top: 20px;\r\n}\r\n\r\n.details-section {\r\n  margin-top: 20px;\r\n}\r\n\r\n.details-section h4 {\r\n  margin-bottom: 10px;\r\n  color: #333;\r\n}\r\n\r\n.details-section pre {\r\n  background: #f5f5f5;\r\n  padding: 10px;\r\n  border-radius: 4px;\r\n  font-size: 12px;\r\n  overflow-x: auto;\r\n}\r\n</style> ","import { render } from \"./History.vue?vue&type=template&id=8f49e7d8&scoped=true\"\nimport script from \"./History.vue?vue&type=script&lang=js\"\nexport * from \"./History.vue?vue&type=script&lang=js\"\n\nimport \"./History.vue?vue&type=style&index=0&id=8f49e7d8&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-8f49e7d8\"]])\n\nexport default __exports__"],"names":["class","header","$t","type","size","loadHistory","data","historyList","loading","style","prop","label","width","default","row","formatDate","time","getStatusType","status","getStatusText","fixed","showDetails","currentPage","pageSize","total","layout","handleSizeChange","handleCurrentChange","showDetailsDialog","title","column","border","selectedRecord","operation","description","user","ip","userAgent","JSON","stringify","details","name","setup","async","value","response","api","operationLogs","getList","page","limit","logs","error","console","dateString","Date","toLocaleString","typeMap","success","failed","pending","textMap","__exports__","render"],"sourceRoot":""}