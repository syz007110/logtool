"use strict";(self["webpackChunklogtool_frontend"]=self["webpackChunklogtool_frontend"]||[]).push([[135],{6135:function(a,e,t){t.r(e),t.d(e,{default:function(){return p}});var l=t(641),n=t(33);const o={class:"data-replay"},r={class:"upload-row"},i={key:0,class:"file-meta"};function d(a,e,t,d,s,c){const u=(0,l.g2)("el-button"),f=(0,l.g2)("el-upload"),_=(0,l.g2)("el-card");return(0,l.uX)(),(0,l.CE)("div",o,[(0,l.bF)(_,{class:"upload-card"},{default:(0,l.k6)(()=>[(0,l.Lk)("div",r,[(0,l.bF)(f,{action:"","http-request":d.handleUploadRequest,"show-file-list":!1,accept:".bin"},{default:(0,l.k6)(()=>[(0,l.bF)(u,{type:"primary"},{default:(0,l.k6)(()=>e[0]||(e[0]=[(0,l.eW)("上传二进制文件(.bin)")])),_:1,__:[0]})]),_:1},8,["http-request"]),(0,l.bF)(u,{disabled:!d.fileId,onClick:d.downloadCsv,plain:""},{default:(0,l.k6)(()=>e[1]||(e[1]=[(0,l.eW)("下载CSV")])),_:1,__:[1]},8,["disabled","onClick"])]),d.fileName?((0,l.uX)(),(0,l.CE)("div",i,[(0,l.Lk)("span",null,"文件: "+(0,n.v_)(d.fileName),1),(0,l.Lk)("span",null,"大小: "+(0,n.v_)(d.prettySize(d.fileSize)),1),(0,l.Lk)("span",null,"总条数: "+(0,n.v_)(d.totalEntries),1)])):(0,l.Q3)("",!0)]),_:1})])}var s=t(953),c=t(163),u=t(5495),f={name:"DataReplay",setup(){const a=(0,s.KR)(""),e=(0,s.KR)(""),t=(0,s.KR)(0),n=(0,s.KR)(0),o=(0,s.KR)(1),r=(0,s.KR)(500),i=(0,s.KR)([]),d=(0,s.KR)([]),f=a=>a<1024?`${a} B`:a<1048576?`${(a/1024).toFixed(1)} KB`:a<1073741824?`${(a/1024/1024).toFixed(1)} MB`:`${(a/1024/1024/1024).toFixed(1)} GB`,_=async({file:l,onSuccess:n,onError:r})=>{try{const r=new FormData;r.append("file",l);const{data:i}=await u.A.motionData.upload(r);a.value=i.id,e.value=i.filename,t.value=i.size,o.value=1,await m(1),n&&n(i)}catch(i){c.nk.error("上传失败"),r&&r(i)}},v=async()=>{const{data:a}=await u.A.motionData.getConfig();d.value=a.columns},p=(0,s.KR)([]);(0,l.wB)(d,()=>{const a=["ulint_data",...Array.from({length:7},(a,e)=>`real_data_${e}`),...Array.from({length:7},(a,e)=>`real_data_${e+7}`),...Array.from({length:7},(a,e)=>`real_data_${e+42}`),...Array.from({length:7},(a,e)=>`real_data_${e+49}`),"real_data_18","real_data_19","real_data_20","real_data_25","real_data_26","real_data_27"];p.value=d.value.filter(e=>a.includes(e.index))});const m=async(e=o.value)=>{if(!a.value)return;const t=(e-1)*r.value,{data:l}=await u.A.motionData.preview(a.value,{offset:t,limit:r.value});i.value=l.rows,n.value=l.totalEntries},w=async()=>{if(a.value)try{const{data:t}=await u.A.motionData.downloadCsv(a.value),l=t instanceof Blob?t:new Blob([t],{type:"text/csv;charset=utf-8"}),n=URL.createObjectURL(l),o=document.createElement("a");o.href=n,o.download=(e.value?.replace(/\.bin$/i,"")||"motion")+".csv",o.click(),URL.revokeObjectURL(n)}catch(t){c.nk.error("下载失败")}};return(0,l.sV)(async()=>{await v()}),{fileId:a,fileName:e,fileSize:t,totalEntries:n,currentPage:o,pageSize:r,rows:i,columnsToShow:p,handleUploadRequest:_,fetchPreview:m,downloadCsv:w,prettySize:f}}},_=t(6262);const v=(0,_.A)(f,[["render",d],["__scopeId","data-v-05f9acbc"]]);var p=v}}]);
//# sourceMappingURL=135.7e9d4b40.js.map