{"version":3,"file":"js/394.74d8e46c.js","mappings":"0MACOA,MAAM,mB,GAEJA,MAAM,c,GACJA,MAAM,kB,GAcNA,MAAM,kB,GAiCAA,MAAM,kB,GAUZA,MAAM,sB,gcA5Df,QAoMM,MApMN,EAoMM,EAlMJ,QAqBM,MArBN,EAqBM,EApBJ,QAYM,MAZN,EAYM,EAXJ,QAUW,G,WATA,EAAAC,Y,qCAAA,EAAW,eACpBC,YAAY,UACZC,MAAA,gBACAC,UAAA,GACC,QAAO,EAAAC,c,CAEGC,QAAM,QACf,IAA6B,EAA7B,QAA6B,Q,iBAApB,IAAU,EAAV,QAAU,K,4CAKzB,QAKM,MALN,EAKM,EAJJ,QAGY,GAHDC,KAAK,UAAW,QAAK,eAAE,EAAAC,eAAgB,I,kBAChD,IAA2B,EAA3B,QAA2B,Q,iBAAlB,IAAQ,EAAR,QAAQ,K,6BAAU,UAE7B,M,WAKJ,QA6CU,GA7CDR,MAAM,aAAW,C,iBACxB,IA8BW,E,qBA9BX,QA8BW,GA7BRS,KAAM,EAAAC,MACNC,QAAS,EAAAA,QACVR,MAAA,gB,kBAGA,IAA2D,EAA3D,QAA2D,GAA1CS,KAAK,WAAWC,MAAM,MAAMC,MAAM,SACnD,QAAuD,GAAtCF,KAAK,QAAQC,MAAM,KAAKC,MAAM,SAC/C,QAIkB,GAJDF,KAAK,OAAOC,MAAM,OAAOC,MAAM,O,CACnCC,SAAO,QAChB,EADoBC,SAAG,EACvB,QAA4C,Q,iBAApC,IAA2B,E,iBAAxB,EAAAC,YAAYD,EAAIE,OAAI,K,oBAGnC,QAMkB,GANDN,KAAK,YAAYC,MAAM,OAAOC,MAAM,M,CACxCC,SAAO,QAChB,EADoBC,SAAG,EACvB,QAES,GAFAT,KAAMS,EAAIG,UAAY,UAAY,U,kBACzC,IAAiC,E,iBAA9BH,EAAIG,UAAY,KAAO,MAAV,K,6BAItB,QAA8D,GAA7CP,KAAK,aAAaC,MAAM,OAAOC,MAAM,SACtD,QAQkB,GARDD,MAAM,KAAKO,MAAM,QAAQN,MAAM,O,CACnCC,SAAO,QAChB,EADoBC,SAAG,EACvB,QAIM,MAJN,EAIM,EAHJ,QAAkD,GAAtC,QAAK,GAAE,EAAAK,WAAWL,I,kBAAM,IAAE,oB,QAAF,MAAE,O,wBACtC,QAA2D,GAA/C,QAAK,GAAE,EAAAM,kBAAkBN,I,kBAAM,IAAI,oB,QAAJ,QAAI,O,wBAC/C,QAAkE,GAAtD,QAAK,GAAE,EAAAO,aAAaP,GAAMT,KAAK,U,kBAAS,IAAE,oB,QAAF,MAAE,O,mEAtBjD,EAAAI,YA6Bb,QAUM,MAVN,EAUM,EATJ,QAQE,GAPC,eAAc,EAAAa,YACd,YAAW,EAAAC,SACX,aAAY,CAAC,GAAI,GAAI,GAAI,KACzBC,MAAO,EAAAA,MACRC,OAAO,0CACN,aAAa,EAAAC,iBACb,gBAAgB,EAAAC,qB,yFAMvB,QA8CY,G,WA7CD,EAAArB,c,qCAAA,EAAa,iBACrBsB,MAAO,EAAAC,YAAc,OAAS,OAC/BjB,MAAM,S,CAqCKkB,QAAM,QACf,IAAwD,EAAxD,QAAwD,GAA5C,QAAK,eAAE,EAAAxB,eAAgB,I,kBAAO,IAAE,oB,QAAF,MAAE,O,OAC5C,QAEY,GAFDD,KAAK,UAAW,QAAO,EAAA0B,WAAatB,QAAS,EAAAuB,Q,kBAAQ,IAEhE,oB,QAFgE,QAEhE,O,iDAvCF,IAiCU,EAjCV,QAiCU,GAhCRC,IAAI,cACHC,MAAO,EAAAC,SACPC,MAAO,EAAAA,MACR,cAAY,S,kBAEZ,IAEe,EAFf,QAEe,GAFDzB,MAAM,MAAMD,KAAK,Y,kBAC7B,IAAkE,EAAlE,QAAkE,G,WAA/C,EAAAyB,SAASE,S,qCAAT,EAAAF,SAAiB,YAAGG,WAAY,EAAAT,a,2CAGrD,QAEe,GAFDlB,MAAM,KAAKD,KAAK,S,kBAC5B,IAAqC,EAArC,QAAqC,G,WAAlB,EAAAyB,SAASI,M,qCAAT,EAAAJ,SAAc,U,gCAEnC,QAIe,GAJDxB,MAAM,OAAOD,KAAK,Q,kBASxB,IAOD,CAf0D,EAAA8B,MAAY,S,WAA3E,QAEY,G,iBAFQ,EAAAL,SAASnB,K,qCAAT,EAAAmB,SAAa,QAAEnC,YAAY,W,kBAClC,IAAqB,G,aAAhC,QAAqG,mBAA3E,EAAAwC,MAARxB,K,WAAlB,QAAqG,GAAnEyB,IAAKzB,EAAK0B,GAAK/B,MAAO,EAAAI,YAAYC,EAAK2B,MAAQC,MAAO5B,EAAK2B,M,oFAI5E,EAAAd,a,4BAArB,QAEe,G,MAFmBlB,MAAM,KAAKD,KAAK,Y,kBAChD,IAAsE,EAAtE,QAAsE,G,WAAnD,EAAAyB,SAASU,S,qCAAT,EAAAV,SAAiB,YAAE9B,KAAK,WAAW,oB,gCAGpC,EAAW,c,WAA/B,QAEe,G,MAFkBM,MAAM,MAAMD,KAAK,Y,kBAChD,IAA+F,EAA/F,QAA+F,G,WAA5E,EAAAyB,SAASU,S,qCAAT,EAAAV,SAAiB,YAAE9B,KAAK,WAAW,mBAAcL,YAAY,c,iDAGlF,QAKe,GALDW,MAAM,KAAKD,KAAK,U,kBAC5B,IAGY,EAHZ,QAGY,G,WAHQ,EAAAyB,SAASW,O,qCAAT,EAAAX,SAAe,UAAEnC,YAAY,Q,kBAC/C,IAAuC,EAAvC,QAAuC,GAA5BW,MAAM,KAAKiC,MAAM,YAC5B,QAAyC,GAA9BjC,MAAM,KAAKiC,MAAM,e,6FAcpC,QA4BY,G,WA3BD,EAAAG,e,uCAAA,EAAc,kBACvBnB,MAAM,OACNhB,MAAM,S,CAmBKkB,QAAM,QACf,IAAyD,EAAzD,QAAyD,GAA7C,QAAK,iBAAE,EAAAiB,gBAAiB,I,kBAAO,IAAE,oB,QAAF,MAAE,O,OAC7C,QAEY,GAFD1C,KAAK,UAAW,QAAO,EAAA2C,eAAiBvC,QAAS,EAAAwC,Y,kBAAY,IAExE,oB,QAFwE,QAExE,O,iDArBF,IAeU,EAfV,QAeU,GAfD,cAAY,SAAO,C,iBAC1B,IAEe,EAFf,QAEe,GAFDtC,MAAM,MAAI,C,iBACtB,IAAyC,EAAzC,QAAyC,qBAAhC,EAAAuC,cAAcb,UAAQ,K,OAGjC,QASe,GATD1B,MAAM,MAAI,C,iBACtB,IAOY,EAPZ,QAOY,G,WAPQ,EAAAwC,a,uCAAA,EAAY,gBAAEnD,YAAY,Q,kBAE1C,IAAqB,G,aADvB,QAKE,mBAJe,EAAAwC,MAARxB,K,WADT,QAKE,GAHCyB,IAAKzB,EAAK0B,GACV/B,MAAO,EAAAI,YAAYC,EAAK2B,MACxBC,MAAO5B,EAAK0B,I,qGAevB,QAkBY,G,WAlBQ,EAAAU,e,uCAAA,EAAc,kBAAExB,MAAM,OAAOhB,MAAM,S,CAc1CkB,QAAM,QACf,IAAyD,EAAzD,QAAyD,GAA7C,QAAK,iBAAE,EAAAsB,gBAAiB,I,kBAAO,IAAE,oB,QAAF,MAAE,O,OAC7C,QAAgE,GAArD/C,KAAK,UAAW,QAAOgD,EAAAA,gB,kBAAgB,IAAE,oB,QAAF,MAAE,O,uCAftD,IAYU,EAZV,QAYU,GAZAnB,MAAOoB,EAAAA,SAAU,cAAY,S,kBACrC,IAEe,EAFf,QAEe,GAFD3C,MAAM,MAAI,C,iBACtB,IAAqC,EAArC,QAAqC,G,WAAlB2C,EAAAA,SAASf,M,uCAATe,EAAAA,SAAc,U,gCAEnC,QAIe,GAJD3C,MAAM,QAAM,C,iBACxB,IAEY,EAFZ,QAEY,G,WAFQ2C,EAAAA,SAAStC,K,uCAATsC,EAAAA,SAAa,S,kBACpB,IAAqB,G,aAAhC,QAAmG,mBAAzE,EAAAd,MAARxB,K,WAAlB,QAAmG,GAAjEyB,IAAKzB,EAAK0B,GAAK/B,MAAO,EAAAI,YAAYC,EAAK2B,MAAQC,MAAO5B,EAAK0B,I,oEAGjG,QAEe,GAFD/B,MAAM,QAAM,C,iBACxB,IAA8E,EAA9E,QAA8E,G,WAA1D2C,EAAAA,SAASrC,U,uCAATqC,EAAAA,SAAkB,aAAE,cAAY,KAAK,gBAAc,M,6EAU7E,QAoBY,G,WAnBD,EAAAC,wB,uCAAA,EAAuB,2BAChC3B,MAAM,OACNhB,MAAM,S,CAaKkB,QAAM,QACf,IAAkE,EAAlE,QAAkE,GAAtD,QAAK,iBAAE,EAAAyB,yBAA0B,I,kBAAO,IAAE,oB,QAAF,MAAE,O,OACtD,QAAkG,GAAvFlD,KAAK,UAAW,QAAO,EAAAmD,oBAAsB/C,QAAS,EAAAgD,mB,kBAAmB,IAAE,oB,QAAF,MAAE,O,iDAbxF,IAUU,EAVV,QAUU,GAVAvB,MAAO,EAAAwB,kBAAoBtB,MAAO,EAAAuB,mBAAoB1B,IAAI,uBAAuB,cAAY,S,kBACrG,IAEe,EAFf,QAEe,GAFDtB,MAAM,MAAMD,KAAK,e,kBAC7B,IAAkF,EAAlF,QAAkF,G,WAA/D,EAAAgD,kBAAkBE,Y,uCAAlB,EAAAF,kBAA6B,eAAErD,KAAK,WAAW,oB,gCAEpE,QAEe,GAFDM,MAAM,MAAMD,KAAK,e,kBAC7B,IAAkF,EAAlF,QAAkF,G,WAA/D,EAAAgD,kBAAkBG,Y,uCAAlB,EAAAH,kBAA6B,eAAErD,KAAK,WAAW,oB,gCAEpE,QAEe,GAFDM,MAAM,QAAQD,KAAK,mB,kBAC/B,IAAsF,EAAtF,QAAsF,G,WAAnE,EAAAgD,kBAAkBI,gB,uCAAlB,EAAAJ,kBAAiC,mBAAErD,KAAK,WAAW,oB,0IAiBhF,GACEsC,KAAM,QACN,KAAAoB,GACE,MAAMC,GAAQ,UACRC,GAAS,UAGTxD,GAAU,SAAI,GACduB,GAAS,SAAI,GACbiB,GAAa,SAAI,GACjB3C,GAAgB,SAAI,GACpByC,GAAiB,SAAI,GACrBlB,GAAc,QAAI,MAClBqB,GAAe,QAAI,MACnBnD,GAAc,QAAI,IAClBuB,GAAc,QAAI,GAClBC,GAAW,QAAI,IACf4B,GAAe,QAAI,IACnBC,GAAiB,SAAI,GAG3B,MAAMc,EAAqB,KAAM,CAC/B7B,SAAU,GACVE,MAAO,GACPM,SAAU,GACVC,OAAQ,SACR9B,KAAM,KAEFmB,GAAW,QAAI+B,KAEf9B,EAAQ,CACZC,SAAU,CACR,CAAE8B,UAAU,EAAMC,QAAS,SAAUC,QAAS,QAC9C,CAAEC,IAAK,EAAGC,IAAK,GAAIH,QAAS,oBAAqBC,QAAS,SAE5D9B,MAAO,CACL,CAAElC,KAAM,QAAS+D,QAAS,aAAcC,QAAS,SAEnDxB,SAAU,CACR,CAAEsB,UAAU,EAAMC,QAAS,QAASC,QAAS,QAC7C,CAAEC,IAAK,EAAGF,QAAS,iBAAkBC,QAAS,SAEhDvB,OAAQ,CACN,CAAEqB,UAAU,EAAMC,QAAS,QAASC,QAAS,WAE/CrD,KAAM,CACJ,CAAEmD,UAAU,EAAMC,QAAS,UAAWC,QAAS,YAK7C7D,GAAQ,QAAS,IAAMwD,EAAMQ,QAAQ,oBACrChC,GAAQ,QAAI,IACZhB,GAAQ,QAAS,IAAMwC,EAAMQ,QAAQ,qBACrCC,GAAW,QAAS,IAAMT,EAAMQ,QAAQ,kBAGxCE,EAAYC,UAChB,IACElE,EAAQmC,OAAQ,QACVoB,EAAMY,SAAS,mBAAoB,CACvCC,KAAMvD,EAAYsB,MAClBkC,MAAOvD,EAASqB,MAChBmC,OAAQhF,EAAY6C,OAExB,CAAE,MAAOoC,GACP,KAAUA,MAAM,SAClB,CAAE,QACAvE,EAAQmC,OAAQ,CAClB,GAGIqC,EAAYN,UAChB,UACoBX,EAAMY,SAAS,oBAEjCpC,EAAMI,MAAQoB,EAAMQ,QAAQ,kBAC9B,CAAE,MAAOQ,GACP,KAAUA,MAAM,SAClB,GAGI7E,EAAe,KACnBmB,EAAYsB,MAAQ,EACpB8B,KAGIhD,EAAoBwD,IACxB3D,EAASqB,MAAQsC,EACjB5D,EAAYsB,MAAQ,EACpB8B,KAGI/C,EAAuBkD,IAC3BvD,EAAYsB,MAAQiC,EACpBH,KAGIS,EAAY,KAChBhD,EAASS,MAAQsB,IACjBrC,EAAYe,MAAQ,MAGhBzB,EAAcL,IAClBe,EAAYe,MAAQ9B,EACpBqB,EAASS,MAAQsB,IACjB/B,EAASS,MAAMP,SAAWvB,EAAIuB,SAC9BF,EAASS,MAAML,MAAQzB,EAAIyB,MAC3BJ,EAASS,MAAME,OAAShC,EAAIgC,OAC5BX,EAASS,MAAM5B,KAAOF,EAAIE,KAC1BV,EAAcsC,OAAQ,GAGlBvB,EAAesD,MAAO7D,IAC1B,UACQ,IAAasE,QAAQ,cAAe,KAAM,CAC9CC,kBAAmB,KACnBC,iBAAkB,KAClBjF,KAAM,kBAGF2D,EAAMY,SAAS,mBAAoB9D,EAAI4B,IAC7C,KAAU6C,QAAQ,QAClBb,GACF,CAAE,MAAOM,GACO,WAAVA,GACF,KAAUA,MAAM,OAEpB,GAGIjD,EAAa4C,UACjB,IACE3C,EAAOY,OAAQ,EACf,MAAMrC,EAAO,IAAK4B,EAASS,OAK3B,GAJIf,EAAYe,QAAUT,EAASS,MAAMC,iBAChCtC,EAAKsC,SAGVtC,EAAKS,KAAM,CAEb,MAAMmC,EAAeX,EAAMI,MAAM4C,KAAKC,GAAKA,EAAE9C,OAASpC,EAAKS,MACvDmC,IACF5C,EAAKiC,MAAQ,CAACW,EAAaT,YAEtBnC,EAAKS,IACd,CACIa,EAAYe,aACRoB,EAAMY,SAAS,mBAAoB,CACvClC,GAAIb,EAAYe,MAAMF,GACtBnC,SAEF,KAAUgF,QAAQ,gBAEZvB,EAAMY,SAAS,mBAAoBrE,GACzC,KAAUgF,QAAQ,SAEpBjF,EAAcsC,OAAQ,EACtBuC,IACAT,GACF,CAAE,MAAOM,GACP,KAAUA,MAAM,OAClB,CAAE,QACAhD,EAAOY,OAAQ,CACjB,GAGI8C,EAAoB5E,IACxBoC,EAAaN,MAAQ9B,EACrBqC,EAAaP,MAAQ9B,EAAI6E,QAAU,GACnC5C,EAAeH,OAAQ,GAGnBI,EAAiB2B,UACrB,IACE1B,EAAWL,OAAQ,QACboB,EAAMY,SAAS,uBAAwB1B,EAAaN,MAAMF,GAAIS,EAAaP,OACjF,KAAU2C,QAAQ,UAClBxC,EAAeH,OAAQ,EACvB8B,GACF,CAAE,MAAOM,GACP,KAAUA,MAAM,SAClB,CAAE,QACA/B,EAAWL,OAAQ,CACrB,GAGIgD,EAAe5E,IACnB,MAAM6E,EAAU,CACdC,MAAO,SACPC,OAAQ,UACRC,KAAM,QAER,OAAOH,EAAQ7E,IAAS,QAGpBD,EAAeC,IACnB,MAAMiF,EAAU,CACdH,MAAO,MACPC,OAAQ,OACRC,KAAM,QAER,OAAOC,EAAQjF,IAASA,GAGpBkF,EAAcC,GACbA,EACE,IAAIC,KAAKD,GAAYE,eAAe,SADnB,KAKpB,QAAU,KACW,UAAnB5B,EAAS7B,OAIf8B,IACAO,KAJEhB,EAAOqC,QAAQ,wBAQnB,MAAM/C,GAA0B,SAAI,GAC9BG,GAAoB,QAAS,CAAEE,YAAa,GAAIC,YAAa,GAAIC,gBAAiB,KAClFL,GAAoB,SAAI,GACxB8C,GAAuB,QAAI,MACjC,IAAIC,EAAc,KAGlB,MAAM7C,EAAqB,CACzBC,YAAa,CACX,CAAEO,UAAU,EAAMC,QAAS,SAAUC,QAAS,SAEhDR,YAAa,CACX,CAAEM,UAAU,EAAMC,QAAS,SAAUC,QAAS,QAC9C,CAAEC,IAAK,EAAGF,QAAS,iBAAkBC,QAAS,SAEhDP,gBAAiB,CACf,CAAEK,UAAU,EAAMC,QAAS,SAAUC,QAAS,QAC9C,CAAEoC,UAAW,CAACC,EAAM9D,EAAO+D,KACnB/D,IAAUc,EAAkBG,YAC9B8C,EAAS,IAAIC,MAAM,gBAEnBD,KAEDtC,QAAS,UAKZjD,EAAqBN,IACzB0F,EAAc1F,EAAI4B,GAClBgB,EAAkBE,YAAc,GAChCF,EAAkBG,YAAc,GAChCH,EAAkBI,gBAAkB,GACpCP,EAAwBX,OAAQ,GAI5BY,EAAsBmB,gBACpB4B,EAAqB3D,MAAMiE,WACjCpD,EAAkBb,OAAQ,EAC1B,UACQoB,EAAMY,SAAS,mBAAoB,CACvClC,GAAI8D,EACJjG,KAAM,CACJqD,YAAaF,EAAkBE,YAC/Bf,SAAUa,EAAkBG,eAGhC,KAAU0B,QAAQ,UAClBhC,EAAwBX,OAAQ,EAChC8B,GACF,CAAE,MAAOM,GACP,KAAUA,MAAMA,EAAM8B,UAAUvG,MAAM6D,SAAW,SACnD,CAAE,QACAX,EAAkBb,OAAQ,CAC5B,GAGF,MAAO,CACLnC,UACAuB,SACAiB,aACA3C,gBACAyC,iBACAlB,cACAqB,eACAnD,cACAuB,cACAC,WACA4B,eACAhB,WACAC,QACA5B,QACAgC,QACAhB,QACArB,eACAuB,mBACAC,sBACAR,aACAE,eACAU,aACA2D,mBACA1C,iBACA4C,cACA7E,cACAmF,aACA9C,iBACAG,0BACAG,oBACAD,oBACA8C,uBACA5C,qBACAvC,oBACAoC,sBAEJ,G,UCngBF,MAAMuD,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,O","sources":["webpack://logtool-frontend/./src/views/Users.vue","webpack://logtool-frontend/./src/views/Users.vue?d380"],"sourcesContent":["<template>\r\n  <div class=\"users-container\">\r\n    <!-- 操作栏 -->\r\n    <div class=\"action-bar\">\r\n      <div class=\"search-section\">\r\n        <el-input\r\n          v-model=\"searchQuery\"\r\n          placeholder=\"搜索用户...\"\r\n          style=\"width: 300px\"\r\n          clearable\r\n          @input=\"handleSearch\"\r\n        >\r\n          <template #prefix>\r\n            <el-icon><Search /></el-icon>\r\n          </template>\r\n        </el-input>\r\n      </div>\r\n      \r\n      <div class=\"action-section\">\r\n        <el-button type=\"primary\" @click=\"showAddDialog = true\">\r\n          <el-icon><Plus /></el-icon>\r\n          添加用户\r\n        </el-button>\r\n      </div>\r\n    </div>\r\n    \r\n    <!-- 用户列表 -->\r\n    <el-card class=\"list-card\">\r\n      <el-table\r\n        :data=\"users\"\r\n        :loading=\"loading\"\r\n        style=\"width: 100%\"\r\n        v-loading=\"loading\"\r\n      >\r\n        <el-table-column prop=\"username\" label=\"用户名\" width=\"120\" />\r\n        <el-table-column prop=\"email\" label=\"邮箱\" width=\"180\" />\r\n        <el-table-column prop=\"role\" label=\"账户类型\" width=\"100\">\r\n          <template #default=\"{ row }\">\r\n            <el-tag>{{ getRoleText(row.role) }}</el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"is_active\" label=\"是否启用\" width=\"90\">\r\n          <template #default=\"{ row }\">\r\n            <el-tag :type=\"row.is_active ? 'success' : 'danger'\">\r\n              {{ row.is_active ? '激活' : '禁用' }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"created_at\" label=\"注册时间\" width=\"150\" />\r\n        <el-table-column label=\"操作\" fixed=\"right\" width=\"260\">\r\n          <template #default=\"{ row }\">\r\n            <div class=\"action-buttons\">\r\n              <el-button @click=\"handleEdit(row)\">编辑</el-button>\r\n              <el-button @click=\"openResetPassword(row)\">重置密码</el-button>\r\n              <el-button @click=\"handleDelete(row)\" type=\"danger\">删除</el-button>\r\n            </div>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      \r\n      <!-- 分页 -->\r\n      <div class=\"pagination-wrapper\">\r\n        <el-pagination\r\n          :current-page=\"currentPage\"\r\n          :page-size=\"pageSize\"\r\n          :page-sizes=\"[10, 20, 50, 100]\"\r\n          :total=\"total\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n        />\r\n      </div>\r\n    </el-card>\r\n    \r\n    <!-- 添加/编辑用户对话框 -->\r\n    <el-dialog\r\n      v-model=\"showAddDialog\"\r\n      :title=\"editingUser ? '编辑用户' : '添加用户'\"\r\n      width=\"500px\"\r\n    >\r\n      <el-form\r\n        ref=\"userFormRef\"\r\n        :model=\"userForm\"\r\n        :rules=\"rules\"\r\n        label-width=\"100px\"\r\n      >\r\n        <el-form-item label=\"用户名\" prop=\"username\">\r\n          <el-input v-model=\"userForm.username\" :disabled=\"!!editingUser\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"邮箱\" prop=\"email\">\r\n          <el-input v-model=\"userForm.email\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"账户类型\" prop=\"role\">\r\n          <el-select v-model=\"userForm.role\" placeholder=\"请选择账户类型\" v-if=\"roles.length\">\r\n            <el-option v-for=\"role in roles\" :key=\"role.id\" :label=\"getRoleText(role.name)\" :value=\"role.name\" />\r\n          </el-select>\r\n        </el-form-item>\r\n        \r\n        <el-form-item v-if=\"!editingUser\" label=\"密码\" prop=\"password\">\r\n          <el-input v-model=\"userForm.password\" type=\"password\" show-password />\r\n        </el-form-item>\r\n        \r\n        <el-form-item v-if=\"editingUser\" label=\"新密码\" prop=\"password\">\r\n          <el-input v-model=\"userForm.password\" type=\"password\" show-password placeholder=\"如需修改请输入新密码\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"状态\" prop=\"status\">\r\n          <el-select v-model=\"userForm.status\" placeholder=\"选择状态\">\r\n            <el-option label=\"激活\" value=\"active\" />\r\n            <el-option label=\"禁用\" value=\"inactive\" />\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-form>\r\n      \r\n      <template #footer>\r\n        <el-button @click=\"showAddDialog = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"handleSave\" :loading=\"saving\">\r\n          保存\r\n        </el-button>\r\n      </template>\r\n    </el-dialog>\r\n    \r\n    <!-- 分配角色对话框 -->\r\n    <el-dialog\r\n      v-model=\"showRoleDialog\"\r\n      title=\"分配角色\"\r\n      width=\"400px\"\r\n    >\r\n      <el-form label-width=\"100px\">\r\n        <el-form-item label=\"用户\">\r\n          <span>{{ selectedUser?.username }}</span>\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"角色\">\r\n          <el-select v-model=\"selectedRole\" placeholder=\"选择角色\">\r\n            <el-option\r\n              v-for=\"role in roles\"\r\n              :key=\"role.id\"\r\n              :label=\"getRoleText(role.name)\"\r\n              :value=\"role.id\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-form>\r\n      \r\n      <template #footer>\r\n        <el-button @click=\"showRoleDialog = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"handleSaveRole\" :loading=\"savingRole\">\r\n          保存\r\n        </el-button>\r\n      </template>\r\n    </el-dialog>\r\n\r\n    <!-- 编辑弹窗 -->\r\n    <el-dialog v-model=\"showEditDialog\" title=\"编辑用户\" width=\"400px\">\r\n      <el-form :model=\"editForm\" label-width=\"100px\">\r\n        <el-form-item label=\"邮箱\">\r\n          <el-input v-model=\"editForm.email\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"账户类型\">\r\n          <el-select v-model=\"editForm.role\">\r\n            <el-option v-for=\"role in roles\" :key=\"role.id\" :label=\"getRoleText(role.name)\" :value=\"role.id\" />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"是否启用\">\r\n          <el-switch v-model=\"editForm.is_active\" active-text=\"激活\" inactive-text=\"禁用\" />\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <el-button @click=\"showEditDialog = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"handleSaveEdit\">保存</el-button>\r\n      </template>\r\n    </el-dialog>\r\n\r\n    <!-- 重置密码弹窗 -->\r\n    <el-dialog\r\n      v-model=\"showResetPasswordDialog\"\r\n      title=\"重置密码\"\r\n      width=\"400px\"\r\n    >\r\n      <el-form :model=\"resetPasswordForm\" :rules=\"resetPasswordRules\" ref=\"resetPasswordFormRef\" label-width=\"100px\">\r\n        <el-form-item label=\"原密码\" prop=\"oldPassword\">\r\n          <el-input v-model=\"resetPasswordForm.oldPassword\" type=\"password\" show-password />\r\n        </el-form-item>\r\n        <el-form-item label=\"新密码\" prop=\"newPassword\">\r\n          <el-input v-model=\"resetPasswordForm.newPassword\" type=\"password\" show-password />\r\n        </el-form-item>\r\n        <el-form-item label=\"确认新密码\" prop=\"confirmPassword\">\r\n          <el-input v-model=\"resetPasswordForm.confirmPassword\" type=\"password\" show-password />\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <el-button @click=\"showResetPasswordDialog = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"handleResetPassword\" :loading=\"resettingPassword\">确定</el-button>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, reactive, computed, onMounted } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { useRouter } from 'vue-router'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\n\r\nexport default {\r\n  name: 'Users',\r\n  setup() {\r\n    const store = useStore()\r\n    const router = useRouter()\r\n    \r\n    // 响应式数据\r\n    const loading = ref(false)\r\n    const saving = ref(false)\r\n    const savingRole = ref(false)\r\n    const showAddDialog = ref(false)\r\n    const showRoleDialog = ref(false)\r\n    const editingUser = ref(null)\r\n    const selectedUser = ref(null)\r\n    const searchQuery = ref('')\r\n    const currentPage = ref(1)\r\n    const pageSize = ref(20)\r\n    const selectedRole = ref('')\r\n    const showEditDialog = ref(false)\r\n    let editUserId = null\r\n\r\n    const getDefaultUserForm = () => ({\r\n      username: '',\r\n      email: '',\r\n      password: '',\r\n      status: 'active',\r\n      role: ''\r\n    })\r\n    const userForm = ref(getDefaultUserForm())\r\n    \r\n    const rules = {\r\n      username: [\r\n        { required: true, message: '请输入用户名', trigger: 'blur' },\r\n        { min: 3, max: 20, message: '用户名长度在 3 到 20 个字符', trigger: 'blur' }\r\n      ],\r\n      email: [\r\n        { type: 'email', message: '请输入正确的邮箱格式', trigger: 'blur' }\r\n      ],\r\n      password: [\r\n        { required: true, message: '请输入密码', trigger: 'blur' },\r\n        { min: 6, message: '密码长度不能少于 6 个字符', trigger: 'blur' }\r\n      ],\r\n      status: [\r\n        { required: true, message: '请选择状态', trigger: 'change' }\r\n      ],\r\n      role: [\r\n        { required: true, message: '请选择账户类型', trigger: 'change' }\r\n      ]\r\n    }\r\n    \r\n    // 计算属性\r\n    const users = computed(() => store.getters['users/usersList'])\r\n    const roles = ref([])\r\n    const total = computed(() => store.getters['users/totalCount'])\r\n    const userRole = computed(() => store.getters['auth/userRole'])\r\n\r\n    // 方法\r\n    const loadUsers = async () => {\r\n      try {\r\n        loading.value = true\r\n        await store.dispatch('users/fetchUsers', {\r\n          page: currentPage.value,\r\n          limit: pageSize.value,\r\n          search: searchQuery.value\r\n        })\r\n      } catch (error) {\r\n        ElMessage.error('加载用户失败')\r\n      } finally {\r\n        loading.value = false\r\n      }\r\n    }\r\n    \r\n    const loadRoles = async () => {\r\n      try {\r\n        const res = await store.dispatch('users/fetchRoles')\r\n        // 直接赋值，避免反复计算\r\n        roles.value = store.getters['users/rolesList']\r\n      } catch (error) {\r\n        ElMessage.error('加载角色失败')\r\n      }\r\n    }\r\n    \r\n    const handleSearch = () => {\r\n      currentPage.value = 1\r\n      loadUsers()\r\n    }\r\n    \r\n    const handleSizeChange = (size) => {\r\n      pageSize.value = size\r\n      currentPage.value = 1\r\n      loadUsers()\r\n    }\r\n    \r\n    const handleCurrentChange = (page) => {\r\n      currentPage.value = page\r\n      loadUsers()\r\n    }\r\n    \r\n    const resetForm = () => {\r\n      userForm.value = getDefaultUserForm()\r\n      editingUser.value = null\r\n    }\r\n    \r\n    const handleEdit = (row) => {\r\n      editingUser.value = row\r\n      userForm.value = getDefaultUserForm()\r\n      userForm.value.username = row.username\r\n      userForm.value.email = row.email\r\n      userForm.value.status = row.status\r\n      userForm.value.role = row.role // 编辑时也带上角色\r\n      showAddDialog.value = true\r\n    }\r\n    \r\n    const handleDelete = async (row) => {\r\n      try {\r\n        await ElMessageBox.confirm('确定要删除这个用户吗？', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        })\r\n        \r\n        await store.dispatch('users/deleteUser', row.id)\r\n        ElMessage.success('删除成功')\r\n        loadUsers()\r\n      } catch (error) {\r\n        if (error !== 'cancel') {\r\n          ElMessage.error('删除失败')\r\n        }\r\n      }\r\n    }\r\n    \r\n    const handleSave = async () => {\r\n      try {\r\n        saving.value = true\r\n        const data = { ...userForm.value }\r\n        if (editingUser.value && !userForm.value.password) {\r\n          delete data.password // 编辑时未填写新密码则不传\r\n        }\r\n        // 账户类型字段处理\r\n        if (data.role) {\r\n          // 查找对应角色id\r\n          const selectedRole = roles.value.find(r => r.name === data.role)\r\n          if (selectedRole) {\r\n            data.roles = [selectedRole.id]\r\n          }\r\n          delete data.role\r\n        }\r\n        if (editingUser.value) {\r\n          await store.dispatch('users/updateUser', {\r\n            id: editingUser.value.id,\r\n            data\r\n          })\r\n          ElMessage.success('更新成功')\r\n        } else {\r\n          await store.dispatch('users/createUser', data)\r\n          ElMessage.success('添加成功')\r\n        }\r\n        showAddDialog.value = false\r\n        resetForm()\r\n        loadUsers()\r\n      } catch (error) {\r\n        ElMessage.error('保存失败')\r\n      } finally {\r\n        saving.value = false\r\n      }\r\n    }\r\n    \r\n    const handleAssignRole = (row) => {\r\n      selectedUser.value = row\r\n      selectedRole.value = row.roleId || ''\r\n      showRoleDialog.value = true\r\n    }\r\n    \r\n    const handleSaveRole = async () => {\r\n      try {\r\n        savingRole.value = true\r\n        await store.dispatch('users/assignUserRole', selectedUser.value.id, selectedRole.value)\r\n        ElMessage.success('角色分配成功')\r\n        showRoleDialog.value = false\r\n        loadUsers()\r\n      } catch (error) {\r\n        ElMessage.error('角色分配失败')\r\n      } finally {\r\n        savingRole.value = false\r\n      }\r\n    }\r\n    \r\n    const getRoleType = (role) => {\r\n      const typeMap = {\r\n        admin: 'danger',\r\n        expert: 'warning',\r\n        user: 'info'\r\n      }\r\n      return typeMap[role] || 'info'\r\n    }\r\n    \r\n    const getRoleText = (role) => {\r\n      const textMap = {\r\n        admin: '管理员',\r\n        expert: '专家用户',\r\n        user: '普通用户'\r\n      }\r\n      return textMap[role] || role\r\n    }\r\n    \r\n    const formatDate = (dateString) => {\r\n      if (!dateString) return '-'\r\n      return new Date(dateString).toLocaleString('zh-CN')\r\n    }\r\n    \r\n    // 生命周期\r\n          onMounted(() => {\r\n        if (userRole.value !== 'admin') {\r\n        router.replace('/dashboard/account')\r\n        return\r\n      }\r\n      loadUsers()\r\n      loadRoles()\r\n    })\r\n    \r\n    // data\r\n    const showResetPasswordDialog = ref(false)\r\n    const resetPasswordForm = reactive({ oldPassword: '', newPassword: '', confirmPassword: '' })\r\n    const resettingPassword = ref(false)\r\n    const resetPasswordFormRef = ref(null)\r\n    let resetUserId = null\r\n\r\n    // 校验规则\r\n    const resetPasswordRules = {\r\n      oldPassword: [\r\n        { required: true, message: '请输入原密码', trigger: 'blur' }\r\n      ],\r\n      newPassword: [\r\n        { required: true, message: '请输入新密码', trigger: 'blur' },\r\n        { min: 6, message: '密码长度不能少于 6 个字符', trigger: 'blur' }\r\n      ],\r\n      confirmPassword: [\r\n        { required: true, message: '请确认新密码', trigger: 'blur' },\r\n        { validator: (rule, value, callback) => {\r\n            if (value !== resetPasswordForm.newPassword) {\r\n              callback(new Error('两次输入的新密码不一致'))\r\n            } else {\r\n              callback()\r\n            }\r\n          }, trigger: 'blur' }\r\n      ]\r\n    }\r\n\r\n    // 打开重置密码弹窗\r\n    const openResetPassword = (row) => {\r\n      resetUserId = row.id\r\n      resetPasswordForm.oldPassword = ''\r\n      resetPasswordForm.newPassword = ''\r\n      resetPasswordForm.confirmPassword = ''\r\n      showResetPasswordDialog.value = true\r\n    }\r\n\r\n    // 重置密码逻辑\r\n    const handleResetPassword = async () => {\r\n      await resetPasswordFormRef.value.validate()\r\n      resettingPassword.value = true\r\n      try {\r\n        await store.dispatch('users/updateUser', {\r\n          id: resetUserId,\r\n          data: {\r\n            oldPassword: resetPasswordForm.oldPassword,\r\n            password: resetPasswordForm.newPassword\r\n          }\r\n        })\r\n        ElMessage.success('密码重置成功')\r\n        showResetPasswordDialog.value = false\r\n        loadUsers()\r\n      } catch (error) {\r\n        ElMessage.error(error.response?.data?.message || '密码重置失败')\r\n      } finally {\r\n        resettingPassword.value = false\r\n      }\r\n    }\r\n    \r\n    return {\r\n      loading,\r\n      saving,\r\n      savingRole,\r\n      showAddDialog,\r\n      showRoleDialog,\r\n      editingUser,\r\n      selectedUser,\r\n      searchQuery,\r\n      currentPage,\r\n      pageSize,\r\n      selectedRole,\r\n      userForm,\r\n      rules,\r\n      users,\r\n      roles,\r\n      total,\r\n      handleSearch,\r\n      handleSizeChange,\r\n      handleCurrentChange,\r\n      handleEdit,\r\n      handleDelete,\r\n      handleSave,\r\n      handleAssignRole,\r\n      handleSaveRole,\r\n      getRoleType,\r\n      getRoleText,\r\n      formatDate,\r\n      showEditDialog,\r\n      showResetPasswordDialog,\r\n      resetPasswordForm,\r\n      resettingPassword,\r\n      resetPasswordFormRef,\r\n      resetPasswordRules,\r\n      openResetPassword,\r\n      handleResetPassword\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.users-container {\r\n  height: 100%;\r\n}\r\n\r\n.action-bar {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n  padding: 20px;\r\n  background: white;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.action-section {\r\n  display: flex;\r\n  gap: 10px;\r\n}\r\n\r\n.list-card {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.pagination-wrapper {\r\n  display: flex;\r\n  justify-content: center;\r\n  margin-top: 20px;\r\n}\r\n\r\n.action-buttons {\r\n  display: flex;\r\n  justify-content: flex-start;\r\n  gap: 8px;\r\n}\r\n</style> ","import { render } from \"./Users.vue?vue&type=template&id=eaf83f9c&scoped=true\"\nimport script from \"./Users.vue?vue&type=script&lang=js\"\nexport * from \"./Users.vue?vue&type=script&lang=js\"\n\nimport \"./Users.vue?vue&type=style&index=0&id=eaf83f9c&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-eaf83f9c\"]])\n\nexport default __exports__"],"names":["class","searchQuery","placeholder","style","clearable","handleSearch","prefix","type","showAddDialog","data","users","loading","prop","label","width","default","row","getRoleText","role","is_active","fixed","handleEdit","openResetPassword","handleDelete","currentPage","pageSize","total","layout","handleSizeChange","handleCurrentChange","title","editingUser","footer","handleSave","saving","ref","model","userForm","rules","username","disabled","email","roles","key","id","name","value","password","status","showRoleDialog","handleSaveRole","savingRole","selectedUser","selectedRole","showEditDialog","handleSaveEdit","editForm","showResetPasswordDialog","handleResetPassword","resettingPassword","resetPasswordForm","resetPasswordRules","oldPassword","newPassword","confirmPassword","setup","store","router","getDefaultUserForm","required","message","trigger","min","max","getters","userRole","loadUsers","async","dispatch","page","limit","search","error","loadRoles","size","resetForm","confirm","confirmButtonText","cancelButtonText","success","find","r","handleAssignRole","roleId","getRoleType","typeMap","admin","expert","user","textMap","formatDate","dateString","Date","toLocaleString","replace","resetPasswordFormRef","resetUserId","validator","rule","callback","Error","validate","response","__exports__","render"],"sourceRoot":""}