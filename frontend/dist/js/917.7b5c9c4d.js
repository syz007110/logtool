"use strict";(self["webpackChunklogtool_frontend"]=self["webpackChunklogtool_frontend"]||[]).push([[917],{3917:function(e,r,a){a.r(r),a.d(r,{default:function(){return k}});var l=a(641),o=a(33);const t={class:"error-codes-container"},d={class:"action-bar"},n={class:"search-section"},i={class:"action-section"},u={class:"pagination-wrapper"};function s(e,r,a,s,c,g){const p=(0,l.g2)("Search"),m=(0,l.g2)("el-icon"),b=(0,l.g2)("el-input"),h=(0,l.g2)("Plus"),C=(0,l.g2)("el-button"),k=(0,l.g2)("Download"),v=(0,l.g2)("el-table-column"),F=(0,l.g2)("el-tag"),y=(0,l.g2)("el-table"),f=(0,l.g2)("el-pagination"),_=(0,l.g2)("el-card"),w=(0,l.g2)("el-form-item"),V=(0,l.g2)("el-option"),x=(0,l.g2)("el-select"),E=(0,l.g2)("el-form"),R=(0,l.g2)("el-dialog"),W=(0,l.gN)("loading");return(0,l.uX)(),(0,l.CE)("div",t,[(0,l.Lk)("div",d,[(0,l.Lk)("div",n,[(0,l.bF)(b,{modelValue:s.searchQuery,"onUpdate:modelValue":r[0]||(r[0]=e=>s.searchQuery=e),placeholder:"搜索故障码...",style:{width:"300px"},clearable:"",onInput:s.handleSearch},{prefix:(0,l.k6)(()=>[(0,l.bF)(m,null,{default:(0,l.k6)(()=>[(0,l.bF)(p)]),_:1})]),_:1},8,["modelValue","onInput"])]),(0,l.Lk)("div",i,[s.canCreate?((0,l.uX)(),(0,l.Wv)(C,{key:0,type:"primary",onClick:r[1]||(r[1]=e=>s.showAddDialog=!0)},{default:(0,l.k6)(()=>[(0,l.bF)(m,null,{default:(0,l.k6)(()=>[(0,l.bF)(h)]),_:1}),r[10]||(r[10]=(0,l.eW)(" 添加故障码 "))]),_:1,__:[10]})):(0,l.Q3)("",!0),(0,l.bF)(C,{type:"success",onClick:s.handleExport,loading:s.exporting},{default:(0,l.k6)(()=>[(0,l.bF)(m,null,{default:(0,l.k6)(()=>[(0,l.bF)(k)]),_:1}),r[11]||(r[11]=(0,l.eW)(" 导出XML "))]),_:1,__:[11]},8,["onClick","loading"])])]),(0,l.bF)(_,{class:"list-card"},{default:(0,l.k6)(()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(y,{data:s.errorCodes,loading:s.loading,style:{width:"100%"}},{default:(0,l.k6)(()=>[(0,l.bF)(v,{prop:"code",label:"故障码",width:"120"}),(0,l.bF)(v,{prop:"name",label:"名称",width:"200"}),(0,l.bF)(v,{prop:"description",label:"描述","show-overflow-tooltip":""}),(0,l.bF)(v,{prop:"category",label:"分类",width:"120"}),(0,l.bF)(v,{prop:"severity",label:"严重程度",width:"100"},{default:(0,l.k6)(({row:e})=>[(0,l.bF)(F,{type:s.getSeverityType(e.severity)},{default:(0,l.k6)(()=>[(0,l.eW)((0,o.v_)(e.severity),1)]),_:2},1032,["type"])]),_:1}),(0,l.bF)(v,{label:"操作",width:"200",fixed:"right"},{default:(0,l.k6)(({row:e})=>[s.canUpdate?((0,l.uX)(),(0,l.Wv)(C,{key:0,size:"small",onClick:r=>s.handleEdit(e)},{default:(0,l.k6)(()=>r[12]||(r[12]=[(0,l.eW)(" 编辑 ")])),_:2,__:[12]},1032,["onClick"])):(0,l.Q3)("",!0),s.canDelete?((0,l.uX)(),(0,l.Wv)(C,{key:1,size:"small",type:"danger",onClick:r=>s.handleDelete(e)},{default:(0,l.k6)(()=>r[13]||(r[13]=[(0,l.eW)(" 删除 ")])),_:2,__:[13]},1032,["onClick"])):(0,l.Q3)("",!0)]),_:1})]),_:1},8,["data","loading"])),[[W,s.loading]]),(0,l.Lk)("div",u,[(0,l.bF)(f,{"current-page":s.currentPage,"page-size":s.pageSize,"page-sizes":[10,20,50,100],total:s.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:s.handleSizeChange,onCurrentChange:s.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]),_:1}),(0,l.bF)(R,{modelValue:s.showAddDialog,"onUpdate:modelValue":r[9]||(r[9]=e=>s.showAddDialog=e),title:s.editingErrorCode?"编辑故障码":"添加故障码",width:"600px"},{footer:(0,l.k6)(()=>[(0,l.bF)(C,{onClick:r[8]||(r[8]=e=>s.showAddDialog=!1)},{default:(0,l.k6)(()=>r[14]||(r[14]=[(0,l.eW)("取消")])),_:1,__:[14]}),(0,l.bF)(C,{type:"primary",onClick:s.handleSave,loading:s.saving},{default:(0,l.k6)(()=>r[15]||(r[15]=[(0,l.eW)(" 保存 ")])),_:1,__:[15]},8,["onClick","loading"])]),default:(0,l.k6)(()=>[(0,l.bF)(E,{ref:"errorCodeForm",model:s.errorCodeForm,rules:s.rules,"label-width":"100px"},{default:(0,l.k6)(()=>[(0,l.bF)(w,{label:"故障码",prop:"code"},{default:(0,l.k6)(()=>[(0,l.bF)(b,{modelValue:s.errorCodeForm.code,"onUpdate:modelValue":r[2]||(r[2]=e=>s.errorCodeForm.code=e)},null,8,["modelValue"])]),_:1}),(0,l.bF)(w,{label:"名称",prop:"name"},{default:(0,l.k6)(()=>[(0,l.bF)(b,{modelValue:s.errorCodeForm.name,"onUpdate:modelValue":r[3]||(r[3]=e=>s.errorCodeForm.name=e)},null,8,["modelValue"])]),_:1}),(0,l.bF)(w,{label:"描述",prop:"description"},{default:(0,l.k6)(()=>[(0,l.bF)(b,{modelValue:s.errorCodeForm.description,"onUpdate:modelValue":r[4]||(r[4]=e=>s.errorCodeForm.description=e),type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),(0,l.bF)(w,{label:"解决方案",prop:"solution"},{default:(0,l.k6)(()=>[(0,l.bF)(b,{modelValue:s.errorCodeForm.solution,"onUpdate:modelValue":r[5]||(r[5]=e=>s.errorCodeForm.solution=e),type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),(0,l.bF)(w,{label:"分类",prop:"category"},{default:(0,l.k6)(()=>[(0,l.bF)(b,{modelValue:s.errorCodeForm.category,"onUpdate:modelValue":r[6]||(r[6]=e=>s.errorCodeForm.category=e)},null,8,["modelValue"])]),_:1}),(0,l.bF)(w,{label:"严重程度",prop:"severity"},{default:(0,l.k6)(()=>[(0,l.bF)(x,{modelValue:s.errorCodeForm.severity,"onUpdate:modelValue":r[7]||(r[7]=e=>s.errorCodeForm.severity=e),placeholder:"选择严重程度"},{default:(0,l.k6)(()=>[(0,l.bF)(V,{label:"低",value:"low"}),(0,l.bF)(V,{label:"中",value:"medium"}),(0,l.bF)(V,{label:"高",value:"high"}),(0,l.bF)(V,{label:"严重",value:"critical"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}var c=a(953),g=a(6278),p=a(163),m=a(7918),b={name:"ErrorCodes",setup(){const e=(0,g.Pj)(),r=(0,c.KR)(!1),a=(0,c.KR)(!1),o=(0,c.KR)(!1),t=(0,c.KR)(!1),d=(0,c.KR)(null),n=(0,c.KR)(""),i=(0,c.KR)(1),u=(0,c.KR)(20),s=(0,c.Kh)({code:"",name:"",description:"",solution:"",category:"",severity:"medium"}),b={code:[{required:!0,message:"请输入故障码",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}],severity:[{required:!0,message:"请选择严重程度",trigger:"change"}]},h=(0,l.EW)(()=>e.getters["errorCodes/errorCodesList"]),C=(0,l.EW)(()=>e.getters["errorCodes/totalCount"]),k=(0,l.EW)(()=>"admin"===e.getters.userRole||"expert"===e.getters.userRole),v=(0,l.EW)(()=>"admin"===e.getters.userRole||"expert"===e.getters.userRole),F=(0,l.EW)(()=>"admin"===e.getters.userRole||"expert"===e.getters.userRole),y=async()=>{try{r.value=!0,await e.dispatch("errorCodes/fetchErrorCodes",{page:i.value,limit:u.value,search:n.value})}catch(a){p.nk.error("加载故障码失败")}finally{r.value=!1}},f=()=>{i.value=1,y()},_=e=>{u.value=e,i.value=1,y()},w=e=>{i.value=e,y()},V=()=>{Object.assign(s,{code:"",name:"",description:"",solution:"",category:"",severity:"medium"}),d.value=null},x=e=>{d.value=e,Object.assign(s,{...e}),t.value=!0},E=async r=>{try{await m.s.confirm("确定要删除这个故障码吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await e.dispatch("errorCodes/deleteErrorCode",r.id),p.nk.success("删除成功"),y()}catch(a){"cancel"!==a&&p.nk.error("删除失败")}},R=async()=>{try{a.value=!0,d.value?(await e.dispatch("errorCodes/updateErrorCode",{id:d.value.id,data:s}),p.nk.success("更新成功")):(await e.dispatch("errorCodes/createErrorCode",s),p.nk.success("添加成功")),t.value=!1,V(),y()}catch(r){p.nk.error("保存失败")}finally{a.value=!1}},W=async()=>{try{o.value=!0;const r=await e.dispatch("errorCodes/exportToXML",{search:n.value}),a=new Blob([r.data],{type:"application/xml"}),l=window.URL.createObjectURL(a),t=document.createElement("a");t.href=l,t.download="error_codes.xml",t.click(),window.URL.revokeObjectURL(l),p.nk.success("导出成功")}catch(r){p.nk.error("导出失败")}finally{o.value=!1}},U=e=>{const r={low:"info",medium:"warning",high:"danger",critical:"danger"};return r[e]||"info"};return(0,l.sV)(()=>{y()}),{loading:r,saving:a,exporting:o,showAddDialog:t,editingErrorCode:d,searchQuery:n,currentPage:i,pageSize:u,errorCodeForm:s,rules:b,errorCodes:h,total:C,canCreate:k,canUpdate:v,canDelete:F,handleSearch:f,handleSizeChange:_,handleCurrentChange:w,handleEdit:x,handleDelete:E,handleSave:R,handleExport:W,getSeverityType:U}}},h=a(6262);const C=(0,h.A)(b,[["render",s],["__scopeId","data-v-20926826"]]);var k=C}}]);
//# sourceMappingURL=917.7b5c9c4d.js.map