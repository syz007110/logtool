{"version":3,"file":"js/33.a08557ce.js","mappings":"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","sources":["webpack://logtool-frontend/./src/views/Analysis.vue","webpack://logtool-frontend/./src/views/Analysis.vue?6759"],"sourcesContent":["<template>\n  <div class=\"analysis-container\">\n    <el-card class=\"analysis-card\">\n        <div class=\"card-header\">\n          <div class=\"header-left\">\n            <span class=\"title\">日志分析</span>\n            <el-tag v-if=\"logInfo.original_name\" type=\"info\" size=\"small\">\n              {{ logInfo.original_name }}\n            </el-tag>\n          </div>\n          <div class=\"header-right\">\n            <el-button \n              v-if=\"!loading && logEntries.length > 0\" \n              @click=\"exportToCSV\" \n              type=\"success\" \n              size=\"small\"\n            >\n              <el-icon><Download /></el-icon>\n              导出CSV\n            </el-button>\n            <el-button \n              v-if=\"!loading && logEntries.length > 0\" \n              @click=\"showSurgeryStatistics\" \n              type=\"primary\" \n              size=\"small\" \n              style=\"margin-left: 10px;\"\n            >\n              <el-icon><DataAnalysis /></el-icon>\n              手术分析\n            </el-button>\n          </div>\n        </div>\n\n      <!-- 日志基本信息 -->\n      <div class=\"log-info\" v-if=\"logInfo.id\">\n        <el-descriptions :column=\"4\" border size=\"small\">\n          <el-descriptions-item label=\"文件名\" :label-style=\"{ width: '100px' }\" :content-style=\"{ width: '100px' }\">\n            <el-tag v-if=\"logInfo.original_name\" size=\"small\">\n            {{ logInfo.original_name }}\n            </el-tag>\n          </el-descriptions-item>\n          <el-descriptions-item label=\"设备编号\">\n            <el-tag v-if=\"logInfo.device_id\" size=\"small\">\n              {{ logInfo.device_id }}\n            </el-tag>\n          </el-descriptions-item>\n          <el-descriptions-item label=\"文件大小\">\n            <el-tag v-if=\"logInfo.size\" size=\"small\">\n              {{ formatFileSize(logInfo.size) }}\n            </el-tag>\n          </el-descriptions-item>\n          <el-descriptions-item label=\"上传用户ID\">\n            <el-tag v-if=\"logInfo.uploader_id\" size=\"small\">\n              {{ logInfo.uploader_id }}\n            </el-tag>\n          </el-descriptions-item>\n        </el-descriptions>\n      </div>\n\n      <!-- 搜索和筛选 -->\n      <div class=\"search-section\">\n        <el-input\n          v-model=\"searchKeyword\"\n          placeholder=\"搜索释义内容或故障码\"\n          style=\"width: 250px; margin-right: 15px;\"\n          clearable\n          @input=\"handleSearch\"\n        >\n          <template #prefix>\n            <el-icon><Search /></el-icon>\n          </template>\n        </el-input>\n        \n        <el-date-picker\n          v-model=\"timeRange\"\n          type=\"datetimerange\"\n          range-separator=\"至\"\n          start-placeholder=\"开始时间\"\n          end-placeholder=\"结束时间\"\n          format=\"YYYY-MM-DD HH:mm:ss\"\n          value-format=\"YYYY-MM-DD HH:mm:ss\"\n          style=\"width: 300px; margin-right: 15px;\"\n          @change=\"handleTimeRangeChange\"\n        />\n        <el-tag v-if=\"timeRangeLimit\" type=\"info\" size=\"small\" style=\"margin-left: 10px;\">\n          可选范围: {{ formatTimestamp(timeRangeLimit[0]) }} 至 {{ formatTimestamp(timeRangeLimit[1]) }}\n        </el-tag>\n        \n        <el-button \n          v-if=\"timeRangeLimit\" \n          @click=\"setFullTimeRange\" \n          type=\"primary\" \n          size=\"small\"\n          style=\"margin-left: 10px;\"\n        >\n          选择全部时间\n        </el-button>\n        \n        <el-button @click=\"clearFilters\" type=\"info\" size=\"small\">\n          清除筛选\n        </el-button>\n      </div>\n\n      <!-- 日志条目表格 -->\n      <div class=\"entries-section\">\n        <div class=\"section-header\">\n          <h3>日志条目 ({{ filteredEntries.length }})</h3>\n        </div>\n\n        <!-- 加载状态 -->\n        <div v-if=\"loading\" class=\"loading-section\">\n          <el-empty description=\"正在加载日志数据...\" />\n        </div>\n\n        <!-- 错误状态 -->\n        <div v-else-if=\"logEntries.length === 0\" class=\"error-section\">\n          <el-empty description=\"未找到日志条目\" />\n        </div>\n\n        <!-- 数据表格 -->\n        <div v-else class=\"table-container\">\n          <el-table \n            :data=\"paginatedEntries\" \n            style=\"width: 100%\"\n            v-loading=\"loading\"\n            height=\"calc(100vh - 350px)\"\n            stripe\n          >\n            <el-table-column prop=\"timestamp\" label=\"时间戳\" width=\"180\" sortable>\n              <template #default=\"{ row }\">\n                {{ formatTimestamp(row.timestamp) }}\n              </template>\n            </el-table-column>\n            <el-table-column prop=\"error_code\" label=\"故障码\" width=\"120\" sortable />\n            <el-table-column prop=\"param1\" label=\"参数1\" width=\"100\" />\n            <el-table-column prop=\"param2\" label=\"参数2\" width=\"100\" />\n            <el-table-column prop=\"param3\" label=\"参数3\" width=\"100\" />\n            <el-table-column prop=\"param4\" label=\"参数4\" width=\"100\" />\n            <el-table-column prop=\"explanation\" label=\"释义\" min-width=\"300\" show-overflow-tooltip />\n          </el-table>\n        </div>\n\n        <!-- 分页 -->\n        <div class=\"pagination-wrapper\" v-if=\"filteredEntries.length > 0\">\n          <el-pagination\n            :current-page=\"currentPage\"\n            :page-size=\"pageSize\"\n            :page-sizes=\"[50, 100, 200, 500]\"\n            :total=\"filteredEntries.length\"\n            layout=\"total, sizes, prev, pager, next, jumper\"\n            @size-change=\"handleSizeChange\"\n            @current-change=\"handleCurrentChange\"\n          />\n        </div>\n      </div>\n    </el-card>\n\n    <!-- 手术统计对话框 -->\n    <el-dialog \n      title=\"手术统计分析\" \n      v-model=\"surgeryStatisticsVisible\"\n      width=\"90%\"\n      :close-on-click-modal=\"false\"\n      :close-on-press-escape=\"false\"\n    >\n      <div class=\"surgery-statistics-content\">\n        <!-- 分析按钮 -->\n        <div class=\"analysis-section\" v-if=\"!surgeryData\">\n          <el-card>\n            <div class=\"analysis-content\">\n              <el-icon><DataAnalysis /></el-icon>\n              <h3>分析当前日志的手术数据</h3>\n              <p>将对当前日志文件进行手术统计分析</p>\n              <el-button type=\"primary\" @click=\"analyzeSurgeryData\" :loading=\"analyzing\">\n                开始分析\n              </el-button>\n            </div>\n          </el-card>\n        </div>\n\n        <!-- 手术统计内容 -->\n        <div v-else>\n          <div v-if=\"surgeryData\">\n            <el-result\n              icon=\"success\"\n              title=\"手术数据分析完成\"\n              sub-title=\"已成功分析出手术数据，详细统计信息请查看手术统计页面\"\n            >\n              <template #extra>\n                <el-button type=\"primary\" @click=\"showSurgeryStatistics\">\n                  查看详细统计\n                </el-button>\n                <el-button @click=\"surgeryStatisticsVisible = false\">\n                  关闭\n                </el-button>\n              </template>\n            </el-result>\n          </div>\n          <div v-else>\n            <el-empty description=\"未分析出手术数据，请检查日志内容\" />\n          </div>\n        </div>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { ref, computed, onMounted } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRoute, useRouter } from 'vue-router'\nimport { ElMessage } from 'element-plus'\nimport { Search, Download, ArrowLeft, DataAnalysis } from '@element-plus/icons-vue'\nimport api from '@/api'\n\nexport default {\n  name: 'Analysis',\n  components: {\n    Search,\n    Download,\n    ArrowLeft,\n    DataAnalysis\n  },\n  setup() {\n    const store = useStore()\n    const route = useRoute()\n    const router = useRouter()\n    \n    const logId = route.params.id\n    const loading = ref(false)\n    const logInfo = ref({})\n    const logEntries = ref([])\n    const searchKeyword = ref('')\n    const timeRange = ref(null)\n    const currentPage = ref(1)\n    const pageSize = ref(100)\n    \n    // 手术统计相关\n    const surgeryStatisticsVisible = ref(false)\n    const surgeryData = ref(null)\n    const analyzing = ref(false)\n\n    // 获取时间范围限制\n    const timeRangeLimit = computed(() => {\n      if (logEntries.value.length === 0) return null\n      \n      const timestamps = logEntries.value.map(entry => new Date(entry.timestamp))\n      const minTime = new Date(Math.min(...timestamps))\n      const maxTime = new Date(Math.max(...timestamps))\n      \n      return [minTime, maxTime]\n    })\n\n    // 过滤后的条目\n    const filteredEntries = computed(() => {\n      let entries = logEntries.value\n      \n      // 搜索过滤\n      if (searchKeyword.value) {\n        entries = entries.filter(entry => \n          entry.explanation.toLowerCase().includes(searchKeyword.value.toLowerCase()) ||\n          entry.error_code.toLowerCase().includes(searchKeyword.value.toLowerCase())\n        )\n      }\n      \n      // 时间范围过滤\n      if (timeRange.value && timeRange.value.length === 2) {\n        const [startTime, endTime] = timeRange.value\n        entries = entries.filter(entry => {\n          const entryTime = new Date(entry.timestamp)\n          const start = new Date(startTime)\n          const end = new Date(endTime)\n          return entryTime >= start && entryTime <= end\n        })\n      }\n      \n      return entries\n    })\n\n    // 分页后的条目\n    const paginatedEntries = computed(() => {\n      const start = (currentPage.value - 1) * pageSize.value\n      const end = start + pageSize.value\n      return filteredEntries.value.slice(start, end)\n    })\n\n    // 加载日志信息\n    const loadLogInfo = async () => {\n      try {\n        const response = await store.dispatch('logs/fetchLogs', { page: 1, limit: 1000 })\n        const log = response.data.logs.find(l => l.id == logId)\n        if (log) {\n          logInfo.value = log\n        } else {\n          ElMessage.error('日志不存在')\n          router.go(-1)\n        }\n      } catch (error) {\n        ElMessage.error('加载日志信息失败')\n      }\n    }\n\n    // 加载日志条目\n    const loadLogEntries = async () => {\n      try {\n        const response = await store.dispatch('logs/fetchLogEntries', logId)\n        logEntries.value = response.data?.entries || response.entries || []\n        \n        // 保存到sessionStorage供手术统计页面使用\n        try {\n          sessionStorage.setItem('batchLogEntries', JSON.stringify(logEntries.value))\n        } catch (error) {\n          // console.warn('保存日志条目到sessionStorage失败:', error)\n        }\n      } catch (error) {\n        ElMessage.error('加载日志条目失败')\n      }\n    }\n\n    // 搜索处理\n    const handleSearch = () => {\n      currentPage.value = 1\n    }\n\n    // 时间范围变化处理\n    const handleTimeRangeChange = () => {\n      currentPage.value = 1\n    }\n\n    // 清除筛选\n    const clearFilters = () => {\n      searchKeyword.value = ''\n      timeRange.value = null\n      currentPage.value = 1\n    }\n\n    // 导出CSV\n    const exportToCSV = () => {\n      const headers = ['时间戳', '故障码', '参数1', '参数2', '参数3', '参数4', '释义']\n      const csvContent = [\n        headers.join(','),\n        ...filteredEntries.value.map(entry => [\n          formatTimestamp(entry.timestamp),\n          entry.error_code,\n          entry.param1,\n          entry.param2,\n          entry.param3,\n          entry.param4,\n          `\"${entry.explanation.replace(/\"/g, '\"\"')}\"`\n        ].join(','))\n      ].join('\\n')\n\n      const blob = new Blob(['\\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' })\n      const link = document.createElement('a')\n      link.href = URL.createObjectURL(blob)\n      link.download = `${logInfo.value.original_name}_analysis.csv`\n      link.click()\n      URL.revokeObjectURL(link.href)\n      \n      ElMessage.success('CSV文件导出成功')\n    }\n\n    // 分页处理\n    const handleSizeChange = (size) => {\n      pageSize.value = size\n      currentPage.value = 1\n    }\n\n    const handleCurrentChange = (page) => {\n      currentPage.value = page\n    }\n\n    // 格式化函数\n    const formatFileSize = (bytes) => {\n      if (bytes === 0) return '0 B'\n      const k = 1024\n      const sizes = ['B', 'KB', 'MB', 'GB']\n      const i = Math.floor(Math.log(bytes) / Math.log(k))\n      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\n    }\n\n    const formatDate = (dateString) => {\n      if (!dateString) return '-'\n      return new Date(dateString).toLocaleString('zh-CN')\n    }\n\n    const formatTimestamp = (timestamp) => {\n      if (!timestamp) return '-'\n      const date = new Date(timestamp)\n      const year = date.getFullYear()\n      const month = String(date.getMonth() + 1).padStart(2, '0')\n      const day = String(date.getDate()).padStart(2, '0')\n      const hours = String(date.getHours()).padStart(2, '0')\n      const minutes = String(date.getMinutes()).padStart(2, '0')\n      const seconds = String(date.getSeconds()).padStart(2, '0')\n      return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`\n    }\n\n    // 设置时间范围为全部\n    const setFullTimeRange = () => {\n      if (timeRangeLimit.value) {\n        timeRange.value = [timeRangeLimit.value[0], timeRangeLimit.value[1]]\n      }\n    }\n\n    // 跳转到手术统计页面\n    const showSurgeryStatistics = () => {\n      // 直接传递日志ID，避免传递大量日志条目数据\n      router.push({\n        path: '/surgery-statistics',\n        query: { logIds: logId }\n      })\n    }\n\n    // 分析手术数据\n    const analyzeSurgeryData = async () => {\n      analyzing.value = true\n      try {\n        // 使用统一的接口，传递单个日志ID数组\n        const response = await api.surgeryStatistics.analyzeByLogIds([logId])\n        if (response.data.success) {\n          // 如果返回的是数组，取第一个手术数据\n          if (Array.isArray(response.data.data)) {\n            surgeryData.value = response.data.data[0] || null\n          } else {\n            surgeryData.value = response.data.data\n          }\n          ElMessage.success('手术数据分析完成')\n        } else {\n          ElMessage.error(response.data.message || '分析手术数据失败')\n        }\n      } catch (error) {\n        ElMessage.error('分析手术数据失败: ' + (error.response?.data?.message || error.message))\n      } finally {\n        analyzing.value = false\n      }\n    }\n\n    onMounted(async () => {\n      loading.value = true\n      try {\n        await loadLogInfo()\n        await loadLogEntries()\n      } finally {\n        loading.value = false\n      }\n    })\n\n    return {\n      loading,\n      logInfo,\n      logEntries,\n      searchKeyword,\n      timeRange,\n      currentPage,\n      pageSize,\n      filteredEntries,\n      paginatedEntries,\n      loadLogInfo,\n      loadLogEntries,\n      handleSearch,\n      handleTimeRangeChange,\n      clearFilters,\n      exportToCSV,\n      handleSizeChange,\n      handleCurrentChange,\n      formatFileSize,\n      formatDate,\n      formatTimestamp,\n      timeRangeLimit,\n      setFullTimeRange,\n      showSurgeryStatistics,\n      analyzeSurgeryData,\n      surgeryStatisticsVisible,\n      surgeryData,\n      analyzing\n    }\n  }\n}\n</script>\n\n<style scoped>\n.analysis-container {\n  padding: 0;\n  height: 100vh;\n  overflow: hidden;\n  background-color: #f5f7fa;\n}\n\n.analysis-card {\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  border-radius: 0;\n  border: none;\n}\n\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 20px;\n  background-color: white;\n  border-bottom: 1px solid #e6e6e6;\n}\n\n.header-left {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.title {\n  font-size: 16px;\n  font-weight: bold;\n}\n\n.log-info {\n  margin: 10px 20px;\n}\n\n.log-info .el-descriptions {\n  font-size: 12px;\n}\n\n.log-info .el-descriptions__label {\n  font-size: 11px;\n  font-weight: 600;\n}\n\n.log-info .el-descriptions__label,\n.log-info .el-descriptions__content {\n  white-space: normal;\n  word-break: break-word;\n}\n\n.search-section {\n  display: flex;\n  align-items: center;\n  margin: 0 20px 10px 20px;\n  padding: 10px 12px;\n  background-color: white;\n  border-radius: 6px;\n  box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n}\n\n.entries-section {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  margin: 0 20px 10px 20px;\n  background-color: white;\n  border-radius: 6px;\n  box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n}\n\n.table-container {\n  flex: 1;\n  overflow: hidden;\n  padding: 0 20px;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 10px;\n  padding: 15px 20px 0 20px;\n}\n\n.section-header h3 {\n  margin: 0;\n  color: #303133;\n  font-size: 14px;\n}\n\n.loading-section,\n.error-section {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 400px;\n  background-color: #fafafa;\n  border-radius: 6px;\n  margin: 20px;\n}\n\n.pagination-wrapper {\n  display: flex;\n  justify-content: center;\n  margin: 10px 20px;\n  padding: 8px 0;\n  background-color: white;\n  border-radius: 6px;\n  box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n}\n\n/* 手术统计对话框样式 */\n.surgery-statistics-content {\n  max-height: 70vh;\n  overflow-y: auto;\n}\n\n.analysis-section {\n  margin: 40px 0;\n}\n\n.analysis-content {\n  text-align: center;\n  padding: 40px;\n}\n\n.analysis-content .el-icon {\n  font-size: 48px;\n  color: #165dff;\n  margin-bottom: 16px;\n}\n\n.analysis-content h3 {\n  margin: 0 0 8px 0;\n  font-size: 18px;\n  color: #1d2129;\n}\n\n.analysis-content p {\n  margin: 0 0 24px 0;\n  color: #86909c;\n}\n</style> ","import { render } from \"./Analysis.vue?vue&type=template&id=0776f753&scoped=true\"\nimport script from \"./Analysis.vue?vue&type=script&lang=js\"\nexport * from \"./Analysis.vue?vue&type=script&lang=js\"\n\nimport \"./Analysis.vue?vue&type=style&index=0&id=0776f753&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-0776f753\"]])\n\nexport default __exports__"],"names":["class","logInfo","type","size","original_name","loading","logEntries","length","exportToCSV","showSurgeryStatistics","style","column","border","label","width","device_id","formatFileSize","uploader_id","searchKeyword","placeholder","clearable","handleSearch","prefix","timeRange","format","handleTimeRangeChange","formatTimestamp","timeRangeLimit","setFullTimeRange","clearFilters","filteredEntries","description","data","paginatedEntries","height","stripe","prop","sortable","default","row","timestamp","currentPage","pageSize","total","layout","handleSizeChange","handleCurrentChange","title","surgeryStatisticsVisible","surgeryData","icon","extra","analyzeSurgeryData","analyzing","name","components","Search","Download","ArrowLeft","DataAnalysis","setup","store","route","router","logId","params","id","value","timestamps","map","entry","Date","minTime","Math","min","maxTime","max","entries","filter","explanation","toLowerCase","includes","error_code","startTime","endTime","entryTime","start","end","slice","loadLogInfo","async","response","dispatch","page","limit","log","logs","find","l","error","go","loadLogEntries","sessionStorage","setItem","JSON","stringify","headers","csvContent","join","param1","param2","param3","param4","replace","blob","Blob","link","document","createElement","href","URL","createObjectURL","download","click","revokeObjectURL","success","bytes","k","sizes","i","floor","parseFloat","pow","toFixed","formatDate","dateString","toLocaleString","date","year","getFullYear","month","String","getMonth","padStart","day","getDate","hours","getHours","minutes","getMinutes","seconds","getSeconds","push","path","query","logIds","api","surgeryStatistics","analyzeByLogIds","Array","isArray","message","__exports__","render"],"sourceRoot":""}