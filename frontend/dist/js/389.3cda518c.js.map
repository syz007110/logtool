{"version":3,"file":"js/389.3cda518c.js","mappings":"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","sources":["webpack://logtool-frontend/./src/views/Account.vue","webpack://logtool-frontend/./src/views/Account.vue?727f"],"sourcesContent":["<template>\r\n  <div class=\"account-container\">\r\n    <el-row :gutter=\"20\">\r\n      <!-- 基本信息 -->\r\n      <el-col :span=\"12\">\r\n        <el-card class=\"profile-card\">\r\n          <template #header>\r\n            <div class=\"card-header\">\r\n              <span>个人信息</span>\r\n            </div>\r\n          </template>\r\n          <el-form ref=\"profileForm\" :model=\"profileData\" :rules=\"profileRules\" label-width=\"100px\">\r\n            <el-form-item label=\"用户名\">\r\n              <el-input v-model=\"profileData.username\" disabled />\r\n            </el-form-item>\r\n            <el-form-item label=\"邮箱\" prop=\"email\">\r\n              <el-input v-model=\"profileData.email\" />\r\n            </el-form-item>\r\n            <el-form-item label=\"角色\">\r\n              <el-tag>{{ getRoleText(profileData.role) }}</el-tag>\r\n            </el-form-item>\r\n            <el-form-item label=\"注册时间\">\r\n              <span>{{ formatDate(profileData.created_at) }}</span>\r\n            </el-form-item>\r\n            <el-form-item>\r\n              <el-button type=\"primary\" @click=\"handleUpdateProfile\" :loading=\"updatingProfile\">保存</el-button>\r\n            </el-form-item>\r\n          </el-form>\r\n        </el-card>\r\n      </el-col>\r\n      <!-- 修改密码 -->\r\n      <el-col :span=\"12\">\r\n        <el-card class=\"password-card\">\r\n          <template #header>\r\n            <div class=\"card-header\">\r\n              <span>修改密码</span>\r\n            </div>\r\n          </template>\r\n          <el-form ref=\"passwordForm\" :model=\"passwordData\" :rules=\"passwordRules\" label-width=\"100px\">\r\n            <el-form-item label=\"原密码\" prop=\"oldPassword\">\r\n              <el-input v-model=\"passwordData.oldPassword\" type=\"password\" show-password />\r\n            </el-form-item>\r\n            <el-form-item label=\"新密码\" prop=\"newPassword\">\r\n              <el-input v-model=\"passwordData.newPassword\" type=\"password\" show-password />\r\n            </el-form-item>\r\n            <el-form-item label=\"确认密码\" prop=\"confirmPassword\">\r\n              <el-input v-model=\"passwordData.confirmPassword\" type=\"password\" show-password />\r\n            </el-form-item>\r\n            <el-form-item>\r\n              <el-button type=\"primary\" @click=\"handleChangePassword\" :loading=\"changingPassword\">修改密码</el-button>\r\n            </el-form-item>\r\n          </el-form>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, reactive, computed, onMounted } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { ElMessage } from 'element-plus'\r\n\r\nexport default {\r\n  name: 'Account',\r\n  setup() {\r\n    const store = useStore()\r\n    \r\n    // 响应式数据\r\n    const updatingProfile = ref(false)\r\n    const changingPassword = ref(false)\r\n    const profileForm = ref(null)\r\n    const passwordForm = ref(null)\r\n    \r\n    const profileData = reactive({\r\n      username: '',\r\n      email: '',\r\n      role: '',\r\n      created_at: ''\r\n    })\r\n    \r\n    const passwordData = reactive({\r\n      oldPassword: '',\r\n      newPassword: '',\r\n      confirmPassword: ''\r\n    })\r\n    \r\n    // 表单验证规则\r\n    const profileRules = {\r\n      email: [\r\n        { required: true, message: '请输入邮箱', trigger: 'blur' },\r\n        { type: 'email', message: '请输入正确的邮箱格式', trigger: 'blur' }\r\n      ]\r\n    }\r\n    \r\n    const validateConfirmPassword = (rule, value, callback) => {\r\n      if (value !== passwordData.newPassword) {\r\n        callback(new Error('两次输入的密码不一致'))\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    \r\n    const passwordRules = {\r\n      oldPassword: [\r\n        { required: true, message: '请输入原密码', trigger: 'blur' }\r\n      ],\r\n      newPassword: [\r\n        { required: true, message: '请输入新密码', trigger: 'blur' },\r\n        { min: 6, message: '密码长度不能少于 6 个字符', trigger: 'blur' }\r\n      ],\r\n      confirmPassword: [\r\n        { required: true, message: '请确认密码', trigger: 'blur' },\r\n        { validator: validateConfirmPassword, trigger: 'blur' }\r\n      ]\r\n    }\r\n    \r\n    // 计算属性\r\n    const currentUser = computed(() => store.getters.currentUser)\r\n    \r\n    // 方法\r\n    const loadUserProfile = () => {\r\n      const user = store.getters['auth/currentUser']\r\n      if (user) {\r\n        Object.assign(profileData, {\r\n          username: user.username,\r\n          email: user.email,\r\n          role: user.role,\r\n          created_at: user.created_at\r\n        })\r\n      }\r\n    }\r\n    \r\n    const handleUpdateProfile = async () => {\r\n      try {\r\n        await profileForm.value.validate()\r\n        updatingProfile.value = true\r\n        await store.dispatch('users/updateUser', {\r\n          id: store.getters['auth/currentUser'].id,\r\n          data: { email: profileData.email }\r\n        })\r\n        ElMessage.success('更新成功')\r\n      } catch (error) {\r\n        ElMessage.error('更新失败')\r\n      } finally {\r\n        updatingProfile.value = false\r\n      }\r\n    }\r\n    \r\n    const handleChangePassword = async () => {\r\n      try {\r\n        await passwordForm.value.validate()\r\n        changingPassword.value = true\r\n        if (passwordData.newPassword !== passwordData.confirmPassword) {\r\n          ElMessage.error('两次输入的新密码不一致')\r\n          return\r\n        }\r\n        await store.dispatch('users/updateUser', {\r\n          id: store.getters['auth/currentUser'].id,\r\n          data: { password: passwordData.newPassword }\r\n        })\r\n        ElMessage.success('密码修改成功')\r\n        Object.assign(passwordData, { oldPassword: '', newPassword: '', confirmPassword: '' })\r\n        passwordForm.value.resetFields()\r\n      } catch (error) {\r\n        ElMessage.error('密码修改失败')\r\n      } finally {\r\n        changingPassword.value = false\r\n      }\r\n    }\r\n    \r\n    const getRoleType = (role) => {\r\n      const typeMap = {\r\n        admin: 'danger',\r\n        expert: 'warning',\r\n        user: 'info'\r\n      }\r\n      return typeMap[role] || 'info'\r\n    }\r\n    \r\n    const getRoleText = (role) => {\r\n      const textMap = {\r\n        admin: '管理员',\r\n        expert: '专家用户',\r\n        user: '普通用户'\r\n      }\r\n      return textMap[role] || role\r\n    }\r\n    \r\n    const formatDate = (dateString) => {\r\n      if (!dateString) return '-'\r\n      return new Date(dateString).toLocaleString('zh-CN')\r\n    }\r\n    \r\n    // 生命周期\r\n    onMounted(() => {\r\n      loadUserProfile()\r\n    })\r\n    \r\n    return {\r\n      updatingProfile,\r\n      changingPassword,\r\n      profileForm,\r\n      passwordForm,\r\n      profileData,\r\n      passwordData,\r\n      profileRules,\r\n      passwordRules,\r\n      handleUpdateProfile,\r\n      handleChangePassword,\r\n      getRoleType,\r\n      getRoleText,\r\n      formatDate\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.account-container {\r\n  height: 100%;\r\n}\r\n\r\n.profile-card,\r\n.password-card {\r\n  height: 100%;\r\n}\r\n\r\n.card-header {\r\n  font-weight: 600;\r\n}\r\n\r\n.el-form-item:last-child {\r\n  margin-bottom: 0;\r\n}\r\n</style> ","import { render } from \"./Account.vue?vue&type=template&id=f7c8ed9e&scoped=true\"\nimport script from \"./Account.vue?vue&type=script&lang=js\"\nexport * from \"./Account.vue?vue&type=script&lang=js\"\n\nimport \"./Account.vue?vue&type=style&index=0&id=f7c8ed9e&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-f7c8ed9e\"]])\n\nexport default __exports__"],"names":["class","gutter","span","header","ref","model","profileData","rules","profileRules","label","username","disabled","prop","email","getRoleText","role","formatDate","created_at","type","handleUpdateProfile","loading","updatingProfile","passwordData","passwordRules","oldPassword","newPassword","confirmPassword","handleChangePassword","changingPassword","name","setup","store","profileForm","passwordForm","required","message","trigger","validateConfirmPassword","rule","value","callback","Error","min","validator","loadUserProfile","getters","currentUser","user","Object","assign","async","validate","dispatch","id","data","success","error","password","resetFields","getRoleType","typeMap","admin","expert","textMap","dateString","Date","toLocaleString","__exports__","render"],"sourceRoot":""}