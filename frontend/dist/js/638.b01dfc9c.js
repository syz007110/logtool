"use strict";(self["webpackChunklogtool_frontend"]=self["webpackChunklogtool_frontend"]||[]).push([[638],{6638:function(e,t,a){a.r(t),a.d(t,{default:function(){return f}});var l=a(641),s=a(33);const i={class:"history-container"},o={class:"card-header"},n={class:"pagination-wrapper"},r={key:0},d={key:0,class:"details-section"};function u(e,t,a,u,c,p){const g=(0,l.g2)("Refresh"),b=(0,l.g2)("el-icon"),h=(0,l.g2)("el-button"),f=(0,l.g2)("el-table-column"),w=(0,l.g2)("el-tag"),_=(0,l.g2)("el-table"),k=(0,l.g2)("el-pagination"),v=(0,l.g2)("el-card"),m=(0,l.g2)("el-descriptions-item"),y=(0,l.g2)("el-descriptions"),W=(0,l.g2)("el-dialog"),S=(0,l.gN)("loading");return(0,l.uX)(),(0,l.CE)("div",i,[(0,l.bF)(v,null,{header:(0,l.k6)(()=>[(0,l.Lk)("div",o,[t[2]||(t[2]=(0,l.Lk)("span",null,"历史记录",-1)),(0,l.bF)(h,{type:"primary",size:"small",onClick:u.loadHistory},{default:(0,l.k6)(()=>[(0,l.bF)(b,null,{default:(0,l.k6)(()=>[(0,l.bF)(g)]),_:1}),t[1]||(t[1]=(0,l.eW)(" 刷新 "))]),_:1,__:[1]},8,["onClick"])])]),default:(0,l.k6)(()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(_,{data:u.historyList,loading:u.loading,style:{width:"100%"}},{default:(0,l.k6)(()=>[(0,l.bF)(f,{prop:"operation",label:"操作",width:"150"}),(0,l.bF)(f,{prop:"description",label:"描述","show-overflow-tooltip":""}),(0,l.bF)(f,{prop:"user",label:"用户",width:"120"}),(0,l.bF)(f,{prop:"time",label:"时间",width:"180"},{default:(0,l.k6)(({row:e})=>[(0,l.eW)((0,s.v_)(u.formatDate(e.time)),1)]),_:1}),(0,l.bF)(f,{prop:"status",label:"状态",width:"100"},{default:(0,l.k6)(({row:e})=>[(0,l.bF)(w,{type:u.getStatusType(e.status)},{default:(0,l.k6)(()=>[(0,l.eW)((0,s.v_)(u.getStatusText(e.status)),1)]),_:2},1032,["type"])]),_:1}),(0,l.bF)(f,{label:"详情",width:"100",fixed:"right"},{default:(0,l.k6)(({row:e})=>[(0,l.bF)(h,{size:"small",type:"primary",onClick:t=>u.showDetails(e)},{default:(0,l.k6)(()=>t[3]||(t[3]=[(0,l.eW)(" 查看 ")])),_:2,__:[3]},1032,["onClick"])]),_:1})]),_:1},8,["data","loading"])),[[S,u.loading]]),(0,l.Lk)("div",n,[(0,l.bF)(k,{"current-page":u.currentPage,"page-size":u.pageSize,"page-sizes":[10,20,50,100],total:u.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:u.handleSizeChange,onCurrentChange:u.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]),_:1}),(0,l.bF)(W,{modelValue:u.showDetailsDialog,"onUpdate:modelValue":t[0]||(t[0]=e=>u.showDetailsDialog=e),title:"操作详情",width:"600px"},{default:(0,l.k6)(()=>[u.selectedRecord?((0,l.uX)(),(0,l.CE)("div",r,[(0,l.bF)(y,{column:1,border:""},{default:(0,l.k6)(()=>[(0,l.bF)(m,{label:"操作"},{default:(0,l.k6)(()=>[(0,l.eW)((0,s.v_)(u.selectedRecord.operation),1)]),_:1}),(0,l.bF)(m,{label:"描述"},{default:(0,l.k6)(()=>[(0,l.eW)((0,s.v_)(u.selectedRecord.description),1)]),_:1}),(0,l.bF)(m,{label:"用户"},{default:(0,l.k6)(()=>[(0,l.eW)((0,s.v_)(u.selectedRecord.user),1)]),_:1}),(0,l.bF)(m,{label:"时间"},{default:(0,l.k6)(()=>[(0,l.eW)((0,s.v_)(u.formatDate(u.selectedRecord.time)),1)]),_:1}),(0,l.bF)(m,{label:"状态"},{default:(0,l.k6)(()=>[(0,l.bF)(w,{type:u.getStatusType(u.selectedRecord.status)},{default:(0,l.k6)(()=>[(0,l.eW)((0,s.v_)(u.getStatusText(u.selectedRecord.status)),1)]),_:1},8,["type"])]),_:1}),(0,l.bF)(m,{label:"IP地址"},{default:(0,l.k6)(()=>[(0,l.eW)((0,s.v_)(u.selectedRecord.ip||"-"),1)]),_:1}),(0,l.bF)(m,{label:"用户代理"},{default:(0,l.k6)(()=>[(0,l.eW)((0,s.v_)(u.selectedRecord.userAgent||"-"),1)]),_:1})]),_:1}),u.selectedRecord.details?((0,l.uX)(),(0,l.CE)("div",d,[t[4]||(t[4]=(0,l.Lk)("h4",null,"详细信息",-1)),(0,l.Lk)("pre",null,(0,s.v_)(JSON.stringify(u.selectedRecord.details,null,2)),1)])):(0,l.Q3)("",!0)])):(0,l.Q3)("",!0)]),_:1},8,["modelValue"])])}var c=a(953),p=a(163),g={name:"History",setup(){const e=(0,c.KR)(!1),t=(0,c.KR)(1),a=(0,c.KR)(20),s=(0,c.KR)(0),i=(0,c.KR)([]),o=(0,c.KR)(!1),n=(0,c.KR)(null),r=[{id:1,operation:"登录",description:"用户登录系统",user:"admin",time:(new Date).toISOString(),status:"success",ip:"192.168.1.100",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",details:{loginMethod:"password"}},{id:2,operation:"上传日志",description:"上传日志文件: system.log",user:"admin",time:new Date(Date.now()-36e5).toISOString(),status:"success",ip:"192.168.1.100",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",details:{filename:"system.log",size:"2.5MB"}},{id:3,operation:"解析日志",description:"解析日志文件: system.log",user:"admin",time:new Date(Date.now()-18e5).toISOString(),status:"success",ip:"192.168.1.100",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",details:{parsedLines:1500,errors:5}},{id:4,operation:"添加故障码",description:"添加故障码: E001",user:"expert",time:new Date(Date.now()-9e5).toISOString(),status:"success",ip:"192.168.1.101",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",details:{code:"E001",name:"系统错误"}},{id:5,operation:"导出XML",description:"导出故障码到XML文件",user:"user",time:new Date(Date.now()-3e5).toISOString(),status:"success",ip:"192.168.1.102",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",details:{exportedCount:150}}],d=async()=>{try{e.value=!0,await new Promise(e=>setTimeout(e,500));const l=(t.value-1)*a.value,o=l+a.value;i.value=r.slice(l,o),s.value=r.length}catch(l){p.nk.error("加载历史记录失败")}finally{e.value=!1}},u=e=>{a.value=e,t.value=1,d()},g=e=>{t.value=e,d()},b=e=>{n.value=e,o.value=!0},h=e=>e?new Date(e).toLocaleString("zh-CN"):"-",f=e=>{const t={success:"success",failed:"danger",pending:"warning"};return t[e]||"info"},w=e=>{const t={success:"成功",failed:"失败",pending:"进行中"};return t[e]||e};return(0,l.sV)(()=>{d()}),{loading:e,currentPage:t,pageSize:a,total:s,historyList:i,showDetailsDialog:o,selectedRecord:n,loadHistory:d,handleSizeChange:u,handleCurrentChange:g,showDetails:b,formatDate:h,getStatusType:f,getStatusText:w}}},b=a(6262);const h=(0,b.A)(g,[["render",u],["__scopeId","data-v-27bdbc78"]]);var f=h}}]);
//# sourceMappingURL=638.b01dfc9c.js.map